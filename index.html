<!DOCTYPE html>
<html lang="en">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="John Doe" />


    
    


<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">



<link rel="stylesheet" href="/css/style.css">



    <style> .article { opacity: 0;} </style>


<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>Hexo</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: 
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






<meta name="generator" content="Hexo 6.0.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/head.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/"></a></h1>
        </hgroup>

        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>Menu</li>
                        <li>Tags</li>
                        
                        <li>Friends</li>
                        
                        
                        <li>About Me</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="/2684047674@qq.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" rel="noopener" href="https://github.com/Dijgory" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS/" rel="tag">JS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VUE/" rel="tag">VUE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0/" rel="tag">学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%A5%E5%B8%B8/" rel="tag">日常</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于前端</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/head.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="/2684047674@qq.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/Dijgory" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="Tags" friends="Friends" about="About Me"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-前端面试反问" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2022/04/11/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%8F%8D%E9%97%AE/" class="article-date">
      <time datetime="2022-04-11T02:43:29.415Z" itemprop="datePublished">2022-04-11</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/04/11/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%8F%8D%E9%97%AE/">前端面试反问</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>反问技术面试官，可以问：</p>
<p>1、自己所应聘的部门有多少人？进去后是由谁负责带？<br>基本上根据这个部门员工的人数，你就可以大致了解他们的实力和规模，甚至是预测出他们这个部门目前处于一个什么样的水平和状态。<br>2、贵公司就前端而言所用到的技术栈？<br>看自己掌握的技术是否与公司所用的技术是否匹配，并且可以看出自己与工作中所需要技能的差距。<br>3、贵公司的培训项目是什么样的呢？<br>4、这次面试多久可以出结果？是否还有下一轮？<br>5、学习建议类<br>（如果面试的时候对自己的技术面很没底的话，这个时候你可以问一问别人关于学习前端的一些经验，一般面试官都很乐于告诉你的）<br>6、您希望我们实习生身上具有什么样的特质呢？<br>（这个是看令人心动的offer上get到的问题，个人觉得很好）<br>7、您面试到现在，看了这么多候选人，您觉得我相对于这个岗位，还有哪些差距需要改善？</p>
<p>反问HR，可以问：</p>
<p>1、公司的公司氛围、团队建设是怎样子的？<br>2、这个岗位出差、加班多吗？<br>3、新人有培训吗？<br>4、公司的晋升机制是什么样子的呢？<br>5、公司有餐补、房补、交通补助之类的吗？<br>6、当面试官问你的薪资要求时，你可以先问一下公司的薪酬体系<br>7、您认为考核这个岗位员工的最重要指标有哪些？<br>8、您觉得这个团队的氛围怎么样？</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-VUE_前端权限开发文档" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2022/04/09/VUE_%E5%89%8D%E7%AB%AF%E6%9D%83%E9%99%90%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/" class="article-date">
      <time datetime="2022-04-09T02:15:51.602Z" itemprop="datePublished">2022-04-09</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/04/09/VUE_%E5%89%8D%E7%AB%AF%E6%9D%83%E9%99%90%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/">VUE_前端权限开发</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="2-安装vue环境，并新建Vue项目"><a href="#2-安装vue环境，并新建Vue项目" class="headerlink" title="2. 安装vue环境，并新建Vue项目"></a>2. 安装vue环境，并新建Vue项目</h2><p>前端我们依然选择的是Vue+ElementUI的组合，主要还是因为这个主流呀。针对Vue，如果还不熟悉的同学，建议去看看这个视频【<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV125411W73W/?fileGuid=HXqVy6jx8qkWKPJq">4个小时带你快速入门vue</a>】，我也是学这个视频入门的，就学了半天，哈哈。主要Js基础扎实点学起来挺快的。</p>
<p>首先我们安装vue的环境，我实践的环境是windows 10哈。</p>
<p>1、首先我们上node.js官网(<a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn/?fileGuid=HXqVy6jx8qkWKPJq">https://nodejs.org/zh-cn/</a>)，下载最新的长期版本，直接运行安装完成之后，我们就已经具备了node和npm的环境啦。</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/054c315f93334390ad411c5f4038fe4a.png" alt="图片"></p>
<p>安装完成之后检查下版本信息：</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/6e0b14343ad840619adefd463c040f73.png" alt="图片"></p>
<p>这就表示你已经安装成功啦，牛逼开始的第一步！</p>
<p>2、接下来，我们安装vue的环境</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 安装淘宝npm</span><br><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class="line"># vue-cli 安装依赖包</span><br><span class="line">cnpm install --g vue-cli</span><br><span class="line"># 打开vue的可视化管理工具界面</span><br><span class="line">vue ui</span><br></pre></td></tr></table></figure>

<p>上面我们分别安装了淘宝npm，cnpm是为了提高我们安装依赖的速度。vue ui是<a target="_blank" rel="noopener" href="https://github.com/vue">@vue</a>/cli3.0增加一个可视化项目管理工具，可以运行项目、打包项目，检查等操作。对于初学者来说，可以少记一些命令，哈哈。<br>3、创建vueadmin-vue项目</p>
<p>运行vue ui之后，</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/594344581ce34fbb99f30f7d9c136fcd.png" alt="图片"></p>
<p>会为我们打开一个<a target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080</a> 的页面：</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/46aa173f32f04e65aa6594b5d1ad3da0.png" alt="图片"></p>
<p>我们将在这个页面完成我们的前端Vue项目的新建。然后切换到【创建】，注意创建的目录最好是和你运行vue ui同一级。这样方便管理和切换。</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/3c913e6167e94bdbab49ac42c4e461cf.png" alt="图片"></p>
<p>然后点击按钮【在此创建新项目】下一步中，项目文件夹中输入项目名称“vueblog-vue”，其他不用改。</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/f9e037d1eb054383a50f5012f4047698.png" alt="图片"></p>
<p>点击下一步，选择【手动】，再点击下一步，如图点击按钮，勾选上路由Router、状态管理Vuex，去掉js的校验。</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/f3221f0464fb4635ae5e706916cd03d0.png" alt="图片"></p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/c6ee8d9cfd994a709908289480f0ee7b.png" alt="图片"></p>
<p>下一步中，也选上【Use history mode for router】，点击创建项目，然后弹窗中选择按钮【创建项目，不保存预设】，就进入项目创建啦。</p>
<p>稍等片刻之后，项目就初始化完成了。上面的步骤中，我们创建了一个vue项目，并且安装了Router、Vuex。这样我们后面就可以直接使用。</p>
<ul>
<li><strong>Router：</strong> WebApp的链接路径管理系统，简单就是建立起url和页面之间的映射关系</li>
<li><strong>Vuex：</strong> 一个专为 Vue.js 应用程序开发的<code>状态管理模式</code>，简单来说就是为了方便数据的操作而建立的一个临时” 前端数据库“，用于各个组件间共享和检测数据变化。</li>
</ul>
<p>ok，我们使用IDEA导入项目，看看创建好的项目长啥样子：</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/0c6901a867474027a12082098ddc0f18.png" alt="图片"></p>
<p>当然了，IDEA我们要预先先安装好一个Vue插件，这样我们就可以使用IDEA像WebStorm一样开发Vue项目啦，毕竟都是同一个家族出品的哈哈。</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/47b9ecfa900347cd8199b51aae5f0369.png" alt="图片"></p>
<p>然后我们在IDEA窗口的底部打开Terminal命令行窗口，输入npm run serve运行vue项目，我们就可以通过<a target="_blank" rel="noopener" href="http://localhost:8080/?fileGuid=HXqVy6jx8qkWKPJq">http://localhost:8080/</a>打开我们的项目了。</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/4e9f8fcb4eb34b12887f8759acca83cb.png" alt="图片"></p>
<p>效果如下，Hello Vue！</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/2ef2f52f5472431c8b79dc34cba0c644.png" alt="图片"></p>
<p>线上演示：<a target="_blank" rel="noopener" href="https://www.markerhub.com/vueadmin/">https://www.markerhub.com/vueadmin/</a></p>
<h2 id="3-安装element-ui"><a href="#3-安装element-ui" class="headerlink" title="3. 安装element-ui"></a>3. 安装element-ui</h2><p>接下来我们引入element-ui组件（<a target="_blank" rel="noopener" href="https://element.eleme.cn/#/zh-CN/component/installation?fileGuid=HXqVy6jx8qkWKPJq">https://element.eleme.cn</a>），这样我们就可以获得好看的vue组件，开发好看的后台管理系统的界面啦。</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/f0bfb7d234cd4d93bd3434fbe17aaeae.png" alt="图片"></p>
<p>命令很简单：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 切换到项目根目录</span><br><span class="line">cd vueadmin-vue</span><br><span class="line"># 或者直接在idea中执行下面命令</span><br><span class="line"># 安装element-ui</span><br><span class="line">cnpm install element-ui --save</span><br></pre></td></tr></table></figure>

<p>然后我们打开项目src目录下的main.js，引入element-ui依赖。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import Element from &#x27;element-ui&#x27;</span><br><span class="line">import &quot;element-ui/lib/theme-chalk/index.css&quot;</span><br><span class="line">Vue.use(Element)</span><br></pre></td></tr></table></figure>

<p>这样我们就可以愉快得在官网上选择组件复制代码到我们项目中直接使用啦。</p>
<h2 id="4-安装axios、qs、mockjs"><a href="#4-安装axios、qs、mockjs" class="headerlink" title="4. 安装axios、qs、mockjs"></a>4. 安装axios、qs、mockjs</h2><ul>
<li><strong>axios</strong>：一个基于 promise 的 HTTP 库，类ajax</li>
<li><strong>qs</strong>：查询参数序列化和解析库</li>
<li><strong>mockjs</strong>：为我们生成随机数据的工具库</li>
</ul>
<p>接下来，我们来安装axios（<a target="_blank" rel="noopener" href="http://www.axios-js.com/?fileGuid=HXqVy6jx8qkWKPJq">http://www.axios-js.com/</a>），axios是一个基于 promise 的 HTTP 库，这样我们进行前后端对接的时候，使用这个工具可以提高我们的开发效率。</p>
<p>安装命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install axios --save</span><br></pre></td></tr></table></figure>

<p>然后同样我们在main.js中全局引入axios。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import axios from &#x27;axios&#x27;</span><br><span class="line">Vue.prototype.$axios = axios //</span><br></pre></td></tr></table></figure>

<p>组件中，我们就可以通过this.$axios.get()来发起我们的请求了哈。当然了，后面我们添加axios拦截的时候我们需要修改引入的编写。<br>同时，我们同步安装一个qs，什么是qs？qs是一个流行的查询参数序列化和解析库。可以将一个普通的object序列化成一个查询字符串，或者反过来将一个查询字符串解析成一个object,帮助我们查询字符串解析和序列化字符串。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install qs --save</span><br></pre></td></tr></table></figure>

<p>然后因为后台我们现在还没有搭建，无法与前端完成数据交互，因此我们这里需要mock数据，因此我们引入mockjs（<a target="_blank" rel="noopener" href="http://mockjs.com/?fileGuid=HXqVy6jx8qkWKPJq">http://mockjs.com/</a>），方便后续我们提供api返回数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install mockjs --save-dev</span><br></pre></td></tr></table></figure>

<p>然后我们在src目录下新建mock.js文件，用于编写随机数据的api，然后我们需要在main.js中引入这个文件：</p>
<ul>
<li><p>src/main.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">require(&quot;./mock&quot;) //引入mock数据，关闭则注释该行</span><br></pre></td></tr></table></figure>

<p>后面我们mackjs会自动为我们拦截ajax，并自动匹配路径返回数据！</p>
<h2 id="5-页面路由"><a href="#5-页面路由" class="headerlink" title="5. 页面路由"></a>5. 页面路由</h2></li>
</ul>
<p>接下来，在开发页面之前我们需要先定义路由。传统项目开发，我们都是通过链接到达控制器然后再到页面渲染的。而类似于Vue这样的前后端分离性质的框架，我们是先访问页面，然后再异步加载数据渲染。而在Vue中，路由的管理是有个专门的组件叫Router管理的。</p>
<p>我们在新建项目的时候也提了一下，大家还记得吧。我们当时说：</p>
<ul>
<li><strong>Router</strong>：WebApp的链接路径管理系统，简单就是建立起url和页面之间的映射关系</li>
</ul>
<p>所以我们要打开页面然后开发页面，我们需要先配置路由，然后再开发，这样我们可以试试看到效果。项目中，src\router\index.js就是用来配置路由的。</p>
<p>我们在views文件夹下定义几个页面：</p>
<ul>
<li>Login.vue（登录页面）</li>
<li>Index.vue（首页）</li>
</ul>
<p>我们新建Vue页面的时候可以这样新建：</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/a79e365a5b484d0dbaa1c7e307f61eee.png" alt="图片"></p>
<p>然后再路由中心配置配置url与vue页面的映射关系，参考原本的默认写法，我们很容易写出以下代码：</p>
<ul>
<li><p>src\router\index.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &#x27;vue&#x27;</span><br><span class="line">import VueRouter from &#x27;vue-router&#x27;</span><br><span class="line">import Login from &quot;../views/Login&quot;;</span><br><span class="line">Vue.use(VueRouter)</span><br><span class="line">const routes = [</span><br><span class="line">&#123;</span><br><span class="line">  path: &#x27;/index&#x27;,</span><br><span class="line">  name: &#x27;Index&#x27;,</span><br><span class="line">  component: () =&gt; import(&#x27;../views/Index.vue&#x27;)</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  path: &#x27;/login&#x27;,</span><br><span class="line">  name: &#x27;Login&#x27;,</span><br><span class="line">  component: Login</span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">mode: &#x27;history&#x27;,</span><br><span class="line">base: process.env.BASE_URL,</span><br><span class="line">routes</span><br><span class="line">&#125;)</span><br><span class="line">export default router</span><br></pre></td></tr></table></figure>

<p>得到效果如下：</p>
</li>
</ul>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/0442a0c0f5f6481c8dafe54e6994b131.png" alt="图片"></p>
<p>通过npm run serve运行项目，打开<a target="_blank" rel="noopener" href="http://localhost:8080/login?fileGuid=HXqVy6jx8qkWKPJq">http://localhost:8080/login</a>发现页面长这样，明显我们新建的Login.vue里面是没有内容的，但这里有个Home|About，明显是被其他地方嵌套过来的，这是啥原因呢？</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/091eb86b20b1487296376bb37cfd3428.png" alt="图片"></p>
<p>这里解释一下，我们新建的Vue项目，如果没其他配置，那么默认的就是一个单页面应用，也就是说这个应用是由一个外壳页面和多个页面片段组成的，页面跳转的时候其实始终都没有离开外壳页面，替换的只是加载的页面片段而已。</p>
<p>那么对应到我们的vueadmin项目，外壳页面就是App.vue，片段页面就是Login.vue，所以我们刚刚通过/login链接看到的页面效果就是App.vue+Login.vue的结果。所以我们进入App.vue页面看看：</p>
<ul>
<li>src/App.vue</li>
</ul>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/b6a2d12ed1594dd5a86c704270614ac4.png" alt="图片"></p>
<p>果然我们在template标签中找到了相关的html，我们把id为nav的这个div直接删除不要了。这个<router-view/>在这里就是现实我们链接到的片段页面，也就是Login.vue。所以这样就清晰了，我们输入url的时候会调整到App.vue，然后路由会匹配到我们对应的vue页面，这样完成的页面就渲染出来了。</p>
<p>然后我们再调整一下全局的样式，具体代码如下：</p>
<ul>
<li>src/App.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">      &lt;router-view/&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">   html, body, #app &#123;</span><br><span class="line">      font-family: &#x27;Helvetica Neue&#x27;, &#x27;Hiragino Sans GB&#x27;, &#x27;WenQuanYi Micro Hei&#x27;, &#x27;Microsoft Yahei&#x27;, sans-serif;</span><br><span class="line">      height: 100%;</span><br><span class="line">      padding: 0;</span><br><span class="line">      margin: 0;</span><br><span class="line">      font-size: 15px;</span><br><span class="line">   &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="6-登陆界面开发"><a href="#6-登陆界面开发" class="headerlink" title="6. 登陆界面开发"></a>6. 登陆界面开发</h2><p>ok，万事具备，接下来我们来开发我们第一个页面Login.vue（<a target="_blank" rel="noopener" href="http://localhost:8080/login?fileGuid=HXqVy6jx8qkWKPJq">http://localhost:8080/login</a>），目前页面是完全空白的。一般登录页面就一个简单的表单：用户名、登录密码和验证码。然后我还想在表单左边添加一个图片，是我自己的公众号的二维码，然后中间用一条竖线分开。</p>
<p>一开始的时候为了页面风格的统一，我们采用了Element Ui的组件库，所以这里我们就直接去element的官网。上面描述中我们需要左右分开显示，所以先找到Loyout布局然后再弄表单，然后我们涉及到的后台交互有2个：</p>
<ul>
<li>获取登录验证码</li>
<li>提交登录表单完成登录</li>
</ul>
<p>因为后台系统我们暂时还没有开发，所以这里我们需要自己mock数据完成交互。前面我们已经引入了mockjs，所以我们到mock.js文件中开发我们的api。</p>
<h4 id="登录交互过程"><a href="#登录交互过程" class="headerlink" title="登录交互过程"></a>登录交互过程</h4><p>我们梳理一下交互流程：</p>
<ol>
<li>浏览器打开登录页面</li>
<li>动态加载登录验证码，因为这是前后端分离的项目，我们不再使用session进行交互，所以后端我打算禁用session，那么验证码的验证就是问题了，所以后端设计上我打算生成验证码同时生成一个随机码，随机码作为key，验证码为value保存到redis中，然后把随机码和验证码图片的Base64字符串码发送到前端</li>
<li>前端提交用户名、密码、验证码还有随机码</li>
<li>后台验证验证码是否匹配以及密码是否正确</li>
</ol>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/4463b9e5c4f14f6b9eb566f8e39c3838.png" alt="图片"></p>
<p>ok，这样我们就知道mock应该弄成什么样的api了。</p>
<ul>
<li>mock.js - 获取登录验证码</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// 引入mockjs</span><br><span class="line">const Mock = require(&#x27;mockjs&#x27;)</span><br><span class="line">// 获取 mock.Random 对象</span><br><span class="line">// 参考：https://github.com/nuysoft/Mock/wiki/Mock.Random</span><br><span class="line">const Random = Mock.Random</span><br><span class="line">let Result = &#123;</span><br><span class="line">   code: 200,</span><br><span class="line">   msg: &#x27;操作成功&#x27;,</span><br><span class="line">   data: null</span><br><span class="line">&#125;</span><br><span class="line">/**</span><br><span class="line"> * Mock.mock( url, post/get , function(options))；</span><br><span class="line"> * url 表示需要拦截的 URL，</span><br><span class="line"> * post/get 需要拦截的 Ajax 请求类型</span><br><span class="line"> *</span><br><span class="line"> * 用于生成响应数据的函数</span><br><span class="line"> */</span><br><span class="line">// 获取验证码图片base64编码以及一个随机码</span><br><span class="line">Mock.mock(&#x27;/captcha&#x27;, &#x27;get&#x27;, () =&gt; &#123;</span><br><span class="line">   Result.data = &#123;</span><br><span class="line">      token: Random.string(32), // 获取一个32位的随机字符串,</span><br><span class="line">      captchaImg: Random.dataImage( &quot;120x40&quot;, &quot;11111&quot; ) //生成验证码为11111的base64图片编码</span><br><span class="line">   &#125;</span><br><span class="line">   return Result</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>mock生成数据还算简单，一般都是利用Mock.Random对象来生成一些随机数据，具体的用法可以参考<a target="_blank" rel="noopener" href="https://github.com/nuysoft/Mock/wiki/Mock.Random%E3%80%82%E7%84%B6%E5%90%8EResult%E6%98%AF%E4%B8%BA%E4%BA%86%E7%BB%9F%E4%B8%80%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%9B%A0%E4%B8%BA%E5%90%8E%E5%8F%B0%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%EF%BC%8C%E4%B8%80%E8%88%AC%E9%83%BD%E6%9C%89%E5%9B%BA%E5%AE%9A%E7%9A%84%E8%BF%94%E5%9B%9E%E6%A0%BC%E5%BC%8F%EF%BC%8C%E6%89%80%E4%BB%A5%E5%B0%B1%E6%9C%89%E4%BA%86Result%E3%80%82">https://github.com/nuysoft/Mock/wiki/Mock.Random。然后Result是为了统一返回结果，因为后台设计的时候，前后端交互，一般都有固定的返回格式，所以就有了Result。</a></p>
<ul>
<li>mock.js - 登录接口</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 因为mock不认识/login?username=xxx，所以用了正则表达式</span><br><span class="line">Mock.mock(RegExp(&#x27;/login*&#x27;), &#x27;post&#x27;, (config) =&gt; &#123;</span><br><span class="line">   // 这里无法在header添加authorization，直接跳过</span><br><span class="line">   console.log(&quot;mock----------------login&quot;)</span><br><span class="line">   return Result</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>Mock我们不需要什么处理，只需要放回的数据符合前端的要求就行哈。这样我们前端就可以继续往后面开发。</p>
<p>然后编写登录页面的js</p>
<ul>
<li>src/views/Login.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;el-row type=&quot;flex&quot; class=&quot;row-bg&quot; justify=&quot;center&quot;&gt;</span><br><span class="line">      &lt;el-col :xl=&quot;6&quot; :lg=&quot;7&quot;&gt;</span><br><span class="line">         &lt;div class=&quot;login-form&quot;&gt;</span><br><span class="line">            &lt;h2&gt;欢迎来到VueAdmin管理系统&lt;/h2&gt;</span><br><span class="line">            &lt;el-image</span><br><span class="line">                  style=&quot;width: 180px; height: 180px&quot;</span><br><span class="line">                  :src=&quot;require(&#x27;@/assets/markerhub/MarkerHub.jpg&#x27;)&quot;</span><br><span class="line">            &gt;&lt;/el-image&gt;</span><br><span class="line">            &lt;p&gt;</span><br><span class="line">               公众号 MarkerHub</span><br><span class="line">            &lt;/p&gt;</span><br><span class="line">            &lt;p&gt;</span><br><span class="line">               扫码二维码，回复【VueAdmin】获取登录密码</span><br><span class="line">            &lt;/p&gt;</span><br><span class="line">         &lt;/div&gt;</span><br><span class="line">      &lt;/el-col&gt;</span><br><span class="line">      &lt;el-col :span=&quot;1&quot;&gt;</span><br><span class="line">         &lt;el-divider direction=&quot;vertical&quot;&gt;&lt;/el-divider&gt;</span><br><span class="line">      &lt;/el-col&gt;</span><br><span class="line">      &lt;el-col :xl=&quot;6&quot; :lg=&quot;7&quot;&gt;</span><br><span class="line">         &lt;el-form label-position=&quot;right&quot; :rules=&quot;rules&quot; label-width=&quot;80px&quot; :model=&quot;loginForm&quot; ref=&quot;loginForm&quot;&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;用户名&quot; prop=&quot;username&quot; style=&quot;width: 380px;&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;loginForm.username&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;密码&quot; prop=&quot;password&quot; style=&quot;width: 380px;&quot;&gt;</span><br><span class="line">               &lt;el-input type=&quot;password&quot; v-model=&quot;loginForm.password&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;验证码&quot; prop=&quot;code&quot; style=&quot;width: 380px;&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;loginForm.code&quot; style=&quot;width: 172px; float: left;&quot; maxlength=&quot;5&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">               &lt;el-image class=&quot;captchaImg&quot; :src=&quot;captchaImg&quot; @click=&quot;getCaptcha&quot;&gt;&lt;/el-image&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item&gt;</span><br><span class="line">               &lt;el-button type=&quot;primary&quot; @click=&quot;submitForm(&#x27;loginForm&#x27;)&quot;&gt;提交&lt;/el-button&gt;</span><br><span class="line">               &lt;el-button @click=&quot;getPass&quot;&gt;获取密码&lt;/el-button&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">         &lt;/el-form&gt;</span><br><span class="line">      &lt;/el-col&gt;</span><br><span class="line">   &lt;/el-row&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">   import qs from &#x27;qs&#x27;</span><br><span class="line">   export default &#123;</span><br><span class="line">      name: &quot;Login&quot;,</span><br><span class="line">      data() &#123;</span><br><span class="line">         return &#123;</span><br><span class="line">            loginForm: &#123;</span><br><span class="line">               username: &#x27;admin&#x27;,</span><br><span class="line">               password: &#x27;markerhub&#x27;,</span><br><span class="line">               code: &#x27;11111&#x27;,</span><br><span class="line">               token: &#x27;&#x27;,</span><br><span class="line">            &#125;,</span><br><span class="line">            rules: &#123;</span><br><span class="line">               username: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请输入用户名&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ],</span><br><span class="line">               password: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请输入密码&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ],</span><br><span class="line">               code: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请输入验证码&#x27;, trigger: &#x27;blur&#x27;&#125;,</span><br><span class="line">                  &#123;min: 5, max: 5, message: &#x27;验证码为5个字符&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ],</span><br><span class="line">            &#125;,</span><br><span class="line">            captchaImg: &#x27;&#x27;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">         submitForm(formName) &#123;</span><br><span class="line">            this.$refs[formName].validate((valid) =&gt; &#123;</span><br><span class="line">               if (valid) &#123;</span><br><span class="line">                  this.$axios.post(&#x27;/login?&#x27; + qs.stringify(this.loginForm)).then(res =&gt; &#123;</span><br><span class="line">                     console.log(res.data)</span><br><span class="line">                     const jwt = res.headers[&#x27;authorization&#x27;]</span><br><span class="line">                     // 将jwt存储到应用store中</span><br><span class="line">                     this.$store.commit(&quot;SET_TOKEN&quot;, jwt)</span><br><span class="line">                     this.$router.push(&quot;/index&quot;)</span><br><span class="line">                  &#125;).catch(error =&gt; &#123;</span><br><span class="line">                     this.getCaptcha();</span><br><span class="line">                     console.log(&#x27;error submit!!&#x27;);</span><br><span class="line">                  &#125;)</span><br><span class="line">               &#125; else &#123;</span><br><span class="line">                  this.getCaptcha();</span><br><span class="line">                  console.log(&#x27;error submit!!&#x27;);</span><br><span class="line">                  return false;</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">         &#125;,</span><br><span class="line">         resetForm(formName) &#123;</span><br><span class="line">            this.$refs[formName].resetFields();</span><br><span class="line">         &#125;,</span><br><span class="line">         getPass() &#123;</span><br><span class="line">            this.$message(&quot;请扫描左边的二维码，回复【VueAdmin】获取登录密码&quot;);</span><br><span class="line">         &#125;,</span><br><span class="line">         getCaptcha() &#123;</span><br><span class="line">            this.$axios.get(&#x27;/captcha&#x27;).then(res =&gt; &#123;</span><br><span class="line">               this.loginForm.token = res.data.data.token</span><br><span class="line">               this.captchaImg = res.data.data.captchaImg</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      created() &#123;</span><br><span class="line">         this.getCaptcha()</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">   .el-col &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      align-items: center;</span><br><span class="line">      height: 100%;</span><br><span class="line">      text-align: center;</span><br><span class="line">   &#125;</span><br><span class="line">   .el-row &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">      background-color: #fafafa;</span><br><span class="line">   &#125;</span><br><span class="line">   .el-divider &#123;</span><br><span class="line">      height: 200px;</span><br><span class="line">   &#125;</span><br><span class="line">   .captchaImg &#123;</span><br><span class="line">      float: left;</span><br><span class="line">      margin-left: 8px;</span><br><span class="line">      border-radius: 4px;</span><br><span class="line">   &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>配合一点样式的调整，这样登录界面我们就开发完毕啦，如果觉得不清楚，可以去看开发视频哈，一步一步的教学，写文字毕竟讲述还是不够仔细的。</p>
<h4 id="token的状态同步"><a href="#token的状态同步" class="headerlink" title="token的状态同步"></a>token的状态同步</h4><p>再讲一下，submitForm方法中，提交表单之后做了几个动作，从Header中获取用户的authorization，也就是含有用户登录信息的jwt，然后提交到store中进行状态管理。this.$store.commit(“SET_TOKEN”, jwt)表示调用store中的SET_TOKEN方法，所以我们需要在store中编写方法：</p>
<ul>
<li>src/store/index.js</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">export default new Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    token: &#x27;&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    SET_TOKEN: (state, token) =&gt; &#123;</span><br><span class="line">      state.token = token</span><br><span class="line">      localStorage.setItem(&quot;token&quot;, token)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  modules: &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>这样登录之后获取到的jwt就可以存储到应用的store以及<strong>localStorage</strong>中，方便使用直接从<strong>localStorage</strong>中获取即可！<br>这样用户登录成功之后就会跳转到/index页面this.$router.push(“/index”)。</p>
<h4 id="定义全局axios拦截器"><a href="#定义全局axios拦截器" class="headerlink" title="定义全局axios拦截器"></a>定义全局axios拦截器</h4><p>这里有个问题，那么如果登录失败，我们是需要弹窗显示错误的，比如验证码错误，用户名或密码不正确等。不仅仅是这个登录接口，所有的接口调用都会有这个情况，所以我们想做个拦截器，对返回的结果进行分析，如果是异常就直接弹窗显示错误，这样我们就省得每个接口都写一遍了。</p>
<p>在src目录下创建一个文件axios.js（与main.js同级），定义axios的拦截：</p>
<ul>
<li>src/axios.js</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import axios from &quot;axios&quot;;</span><br><span class="line">import Element from &#x27;element-ui&#x27;</span><br><span class="line">import router from &quot;./router&quot;;</span><br><span class="line">axios.defaults.baseURL = &quot;http://localhost:8081&quot;</span><br><span class="line">const request = axios.create(&#123;</span><br><span class="line">   timeout: 5000,</span><br><span class="line">   headers: &#123;</span><br><span class="line">      &#x27;Content-Type&#x27;: &#x27;application/json; charset=utf-8&#x27;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;)</span><br><span class="line">request.interceptors.request.use(config =&gt; &#123;</span><br><span class="line">   config.headers[&#x27;Authorization&#x27;] = localStorage.getItem(&quot;token&quot;) // 请求头带上token</span><br><span class="line">   return config</span><br><span class="line">&#125;)</span><br><span class="line">request.interceptors.response.use(response =&gt; &#123;</span><br><span class="line">      let res = response.data;</span><br><span class="line">      console.log(&quot;response&quot;)</span><br><span class="line">      console.log(res)</span><br><span class="line">      if (res.code === 200) &#123;</span><br><span class="line">         return response</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">         Element.Message.error(res.msg? res.msg : &#x27;系统异常！&#x27;, &#123;duration: 3 * 1000&#125;)</span><br><span class="line">         return Promise.reject(response.data.msg)</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;,</span><br><span class="line">   error =&gt; &#123;</span><br><span class="line">      console.log(error)</span><br><span class="line">      if(error.response.data) &#123;</span><br><span class="line">         error.message = error.response.data.msg</span><br><span class="line">      &#125;</span><br><span class="line">      if(error.response.status === 401) &#123;</span><br><span class="line">         router.push(&quot;/login&quot;)</span><br><span class="line">      &#125;</span><br><span class="line">      Element.Message.error(error.message, &#123;duration: 3 * 1000&#125;)</span><br><span class="line">      return Promise.reject(error)</span><br><span class="line">   &#125;</span><br><span class="line">)</span><br><span class="line">export default request</span><br></pre></td></tr></table></figure>

<p>前置拦截，其实可以统一为所有需要权限的请求装配上header的token信息，后置拦截中，判断status.code和error.response.status，如果是401未登录没权限的就调到登录页面，其他的就直接弹窗显示错误。<br>然后再main.js中导入axios.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import request from &quot;./axios&quot;;</span><br><span class="line">Vue.prototype.$axios = request</span><br></pre></td></tr></table></figure>

<p>同时，记得去掉我们之前添加的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import axios from &#x27;axios&#x27;</span><br><span class="line">Vue.prototype.$axios = axios //</span><br></pre></td></tr></table></figure>

<p>这样axios每次请求都会被前置拦截器和后置拦截器拦截了。<br>登录异常弹窗效果如下：</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/87e1201ca5ce43079f123b658d16ff56.png" alt="图片"></p>
<h2 id="7-后台管理界面开发"><a href="#7-后台管理界面开发" class="headerlink" title="7. 后台管理界面开发"></a>7. 后台管理界面开发</h2><p>ok，登录界面我们已经开发完毕，并且我们已经能够进入管理系统的首页了，接下来我们就来开发首页的页面。</p>
<p>一般来说，管理系统的页面我们都是头部是一个简单的信息展示系统名称和登录用户信息，然后中间的左边是菜单导航栏，右边是内容，对应到elementui的组件中，我们可以找到这个Container 布局容器用于布局，方便快速搭建页面的基本结构。</p>
<p>而我们采用这个布局：</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/82b3e8f7ec5b4e7cb9f21953f4da1795.png" alt="图片"></p>
<p>而这个页面，一般来说Header和Aside都是不会变化的，只有Main部分会跟着链接变化而变化，所以我们可以提炼公共部分出来，放在Home.vue中，然后Main部分放在Index.vue中，</p>
<p>那么问题来了，我们如何才能做到点击左边的Aside，然后局部刷新Main中的内容呢？在Vue中，我们可以通过嵌套路由（子路由）的形式。也就是我们需要重新定义路由，一级路由是Home.vue，Index.vue是作为Home.vue页面的子路由，然后Home.vue中我们通过<router-view>来展示Index.vue的内容即可。</p>
<p>在router中，我们这样修改：</p>
<ul>
<li>src/router/index.js</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">const routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: &#x27;/&#x27;,</span><br><span class="line">    name: &#x27;Home&#x27;,</span><br><span class="line">    component: Home,</span><br><span class="line">    children: [</span><br><span class="line">      &#123;</span><br><span class="line">        path: &#x27;/index&#x27;,</span><br><span class="line">        name: &#x27;Index&#x27;,</span><br><span class="line">        meta: &#123;</span><br><span class="line">          title: &quot;首页&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        component: () =&gt; import(&#x27;@/views/Index.vue&#x27;)</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: &#x27;/login&#x27;,</span><br><span class="line">    name: &#x27;Login&#x27;,</span><br><span class="line">    component: Login</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>可以看到原本的Index已经作为了Home的children，所以在链接到/index的时候我们会展示父级Home的内容，然后再显示Index内容。</p>
<ul>
<li>src/views/Home.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;el-container&gt;</span><br><span class="line">      &lt;el-aside width=&quot;200px&quot;&gt;</span><br><span class="line">         &lt;div&gt;菜单栏&lt;/div&gt;</span><br><span class="line">      &lt;/el-aside&gt;</span><br><span class="line">      &lt;el-container&gt;</span><br><span class="line">         &lt;el-header style=&quot;height: 55px;&quot;&gt;</span><br><span class="line">            &lt;Strong&gt;ManHub后台管理系统&lt;/Strong&gt;</span><br><span class="line">            &lt;div class=&quot;header-avatar block&quot;&gt;</span><br><span class="line">               &lt;el-avatar class=&quot;el-avatar&quot; size=&quot;medium&quot; :src=&quot;userInfo.avatar&quot;&gt;&lt;/el-avatar&gt;</span><br><span class="line">               &lt;el-dropdown&gt;</span><br><span class="line">                      &lt;span class=&quot;el-dropdown-link&quot;&gt;</span><br><span class="line">                        &#123;&#123;userInfo.username&#125;&#125;&lt;i class=&quot;el-icon-arrow-down el-icon--right&quot;&gt;&lt;/i&gt;</span><br><span class="line">                      &lt;/span&gt;</span><br><span class="line">                  &lt;el-dropdown-menu slot=&quot;dropdown&quot;&gt;</span><br><span class="line">                     &lt;el-dropdown-item :underline=&quot;false&quot;&gt;</span><br><span class="line">                        &lt;router-link :to=&quot;&#123;name: &#x27;UserCenter&#x27;&#125;&quot;&gt;个人中心&lt;/router-link&gt;</span><br><span class="line">                     &lt;/el-dropdown-item&gt;</span><br><span class="line">                     &lt;el-dropdown-item @click.native=&quot;logout&quot;&gt;退出&lt;/el-dropdown-item&gt;</span><br><span class="line">                  &lt;/el-dropdown-menu&gt;</span><br><span class="line">               &lt;/el-dropdown&gt;</span><br><span class="line">               &lt;el-link href=&quot;https://space.bilibili.com/13491144&quot;&gt;视频讲解&lt;/el-link&gt;</span><br><span class="line">               &lt;el-link href=&quot;http://markerhub.com&quot;&gt;网站&lt;/el-link&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">         &lt;/el-header&gt;</span><br><span class="line">         &lt;el-main&gt;</span><br><span class="line"></span><br><span class="line">            &lt;div style=&quot;margin: 0 15px;&quot;&gt;</span><br><span class="line">               &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">         &lt;/el-main&gt;</span><br><span class="line">      &lt;/el-container&gt;</span><br><span class="line">   &lt;/el-container&gt;</span><br><span class="line"></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">   export default &#123;</span><br><span class="line">      name: &quot;Home.vue&quot;,</span><br><span class="line">      data() &#123;</span><br><span class="line">         return &#123;</span><br><span class="line">            userInfo: &#123;</span><br><span class="line">               id: &#x27;-1&#x27;,</span><br><span class="line">               username: &#x27;admin&#x27;,</span><br><span class="line">               avatar: &#x27;https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/5a9f48118166308daba8b6da7e466aab.jpg&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>样式部分我就不贴出来了，看git上的代码哈。<br>首页中间内容，不知道放啥，就放我的公众号二维码吧，哈哈，欢迎关注关注！</p>
<ul>
<li>src/views/Index.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;div style=&quot;text-align: center;&quot;&gt;</span><br><span class="line">      &lt;h2&gt;&lt;/h2&gt;</span><br><span class="line">      &lt;el-image</span><br><span class="line">            style=&quot;width: 180px; height: 180px&quot;</span><br><span class="line">            :src=&quot;require(&#x27;@/assets/markerhub/javacat.jpg&#x27;)&quot;</span><br><span class="line">      &gt;&lt;/el-image&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">         更多项目学习，扫描关注公众号！</span><br><span class="line">      &lt;/p&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>总体下来效果如下：<br><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/d9c4b269285e430c8540af5ca965edf3.png" alt="图片"></p>
<p>有点感觉了，然后昨天的菜单栏我们也弄下，我们找到NavMenu 导航菜单组件，然后加到Home.vue中，因为考虑到后面我们需要做动态菜单，所以我想单独这个页面出来，因此我新建了个SideMenu.vue：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;el-menu</span><br><span class="line">            class=&quot;el-menu-vertical-demo&quot;</span><br><span class="line">            background-color=&quot;#545c64&quot;</span><br><span class="line">            text-color=&quot;#fff&quot;</span><br><span class="line">            active-text-color=&quot;#ffd04b&quot;</span><br><span class="line">    &gt;</span><br><span class="line">        &lt;router-link to=&quot;/index&quot;&gt;</span><br><span class="line">            &lt;el-menu-item index=&quot;Index&quot;&gt;</span><br><span class="line">                &lt;template slot=&quot;title&quot;&gt;</span><br><span class="line">                    &lt;i class=&quot;el-icon-s-home&quot;&gt;&lt;/i&gt;</span><br><span class="line">                    &lt;span slot=&quot;title&quot;&gt;首页&lt;/span&gt;</span><br><span class="line">                &lt;/template&gt;</span><br><span class="line">            &lt;/el-menu-item&gt;</span><br><span class="line">        &lt;/router-link&gt;</span><br><span class="line">        &lt;el-submenu index=&quot;1&quot;&gt;</span><br><span class="line">            &lt;template slot=&quot;title&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;el-icon-s-operation&quot;&gt;&lt;/i&gt;</span><br><span class="line">                &lt;span&gt;系统管理&lt;/span&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">            &lt;el-menu-item index=&quot;1-1&quot;&gt;</span><br><span class="line">                &lt;template slot=&quot;title&quot;&gt;</span><br><span class="line">                    &lt;i class=&quot;el-icon-s-custom&quot;&gt;&lt;/i&gt;</span><br><span class="line">                    &lt;span slot=&quot;title&quot;&gt;用户管理&lt;/span&gt;</span><br><span class="line">                &lt;/template&gt;</span><br><span class="line">            &lt;/el-menu-item&gt;</span><br><span class="line">            &lt;el-menu-item index=&quot;1-2&quot;&gt;</span><br><span class="line">                &lt;template slot=&quot;title&quot;&gt;</span><br><span class="line">                    &lt;i class=&quot;el-icon-rank&quot;&gt;&lt;/i&gt;</span><br><span class="line">                    &lt;span slot=&quot;title&quot;&gt;角色管理&lt;/span&gt;</span><br><span class="line">                &lt;/template&gt;</span><br><span class="line">            &lt;/el-menu-item&gt;</span><br><span class="line">            &lt;el-menu-item index=&quot;1-3&quot;&gt;</span><br><span class="line">                &lt;template slot=&quot;title&quot;&gt;</span><br><span class="line">                    &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">                    &lt;span slot=&quot;title&quot;&gt;菜单管理&lt;/span&gt;</span><br><span class="line">                &lt;/template&gt;</span><br><span class="line">            &lt;/el-menu-item&gt;</span><br><span class="line">        &lt;/el-submenu&gt;</span><br><span class="line">        &lt;el-submenu index=&quot;2&quot;&gt;</span><br><span class="line">            &lt;template slot=&quot;title&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;el-icon-s-tools&quot;&gt;&lt;/i&gt;</span><br><span class="line">                &lt;span&gt;系统工具&lt;/span&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">            &lt;el-menu-item index=&quot;2-2&quot;&gt;</span><br><span class="line">                &lt;template slot=&quot;title&quot;&gt;</span><br><span class="line">                    &lt;i class=&quot;el-icon-s-order&quot;&gt;&lt;/i&gt;</span><br><span class="line">                    &lt;span slot=&quot;title&quot;&gt;数字字典&lt;/span&gt;</span><br><span class="line">                &lt;/template&gt;</span><br><span class="line">            &lt;/el-menu-item&gt;</span><br><span class="line">        &lt;/el-submenu&gt;</span><br><span class="line">    &lt;/el-menu&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">    export default &#123;</span><br><span class="line">        name: &quot;SideMenu&quot;,</span><br><span class="line">        data() &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">    .el-menu-vertical-demo &#123;</span><br><span class="line">        height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">    a&#123;</span><br><span class="line">        text-decoration:none;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>SideMenu.vue作为一个组件添加到Home.vue中，我们首选需要导入，然后声明compoents，然后才能使用标签，所以在Home.vue中代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;el-container&gt;</span><br><span class="line">      &lt;el-aside width=&quot;200px&quot;&gt;</span><br><span class="line">         &lt;SideMenu&gt;&lt;/SideMenu&gt;</span><br><span class="line">      &lt;/el-aside&gt;</span><br><span class="line">      &lt;el-container&gt;</span><br><span class="line">        ...</span><br><span class="line">      &lt;/el-container&gt;</span><br><span class="line">   &lt;/el-container&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">   import SideMenu from &quot;./inc/SideMenu&quot;;</span><br><span class="line">   export default &#123;</span><br><span class="line">      name: &quot;Home.vue&quot;,</span><br><span class="line">      components: &#123;</span><br><span class="line">         SideMenu</span><br><span class="line">      &#125;,</span><br><span class="line">      data() &#123;</span><br><span class="line">         ...</span><br><span class="line">      &#125;,</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>注意SideMenu出现的地方哈，最后效果如下：<br><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/028e4b63b8594949b2736e3046fa4198.png" alt="图片"></p>
<p>这就很接近我们想要的效果了哈。</p>
<p>我们先来新建几个页面，先在views下新建文件夹sys，然后再新建vue页面，具体看下面，这样我们就能把链接和页面可以连接起来。</p>
<ul>
<li>src\views\sys<ul>
<li>Dict.vue 数字字典</li>
<li>Menu.vue 菜单管理</li>
<li>Role.vue 角色管理</li>
<li>User.vue 用户管理</li>
</ul>
</li>
</ul>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/ea5fc230191e4bc2911cb1c9056712ab.png" alt="图片"></p>
<p>虽然建立了页面，但是因为我们没有在router中注册链接与组件的关系，所以我们现在打开链接还是打开不了页面的。下面我们就要动态联系起来。</p>
<h2 id="8-用户登录信息展示"><a href="#8-用户登录信息展示" class="headerlink" title="8. 用户登录信息展示"></a>8. 用户登录信息展示</h2><p>管理界面的右上角的用户信息现在是写死的，因为我们现在已经登录成功，所以我们可以通过接口去请求获取到当前的用户信息了，这样我们就可以动态显示用户的信息，这个接口比较简单，然后退出登录的链接也一起完成，就请求接口同时把浏览器中的缓存删除就退出了哈。</p>
<ul>
<li>src\views\Home.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-header style=&quot;height: 55px;&quot;&gt;</span><br><span class="line">    &lt;Strong&gt;ManHub后台管理系统&lt;/Strong&gt;</span><br><span class="line">    &lt;div class=&quot;header-avatar block&quot;&gt;</span><br><span class="line">        &lt;el-avatar class=&quot;el-avatar&quot; size=&quot;medium&quot; :src=&quot;userInfo.avatar&quot;&gt;&lt;/el-avatar&gt;</span><br><span class="line">        &lt;el-dropdown&gt;</span><br><span class="line">          &lt;span class=&quot;el-dropdown-link&quot;&gt;</span><br><span class="line">            &#123;&#123;userInfo.username&#125;&#125;&lt;i class=&quot;el-icon-arrow-down el-icon--right&quot;&gt;&lt;/i&gt;</span><br><span class="line">          &lt;/span&gt;</span><br><span class="line">            &lt;el-dropdown-menu slot=&quot;dropdown&quot;&gt;</span><br><span class="line">                &lt;el-dropdown-item :underline=&quot;false&quot;&gt;</span><br><span class="line">                    &lt;router-link :to=&quot;&#123;name: &#x27;UserCenter&#x27;&#125;&quot;&gt;个人中心&lt;/router-link&gt;</span><br><span class="line">                &lt;/el-dropdown-item&gt;</span><br><span class="line">                &lt;el-dropdown-item @click.native=&quot;logout&quot;&gt;退出&lt;/el-dropdown-item&gt;</span><br><span class="line">            &lt;/el-dropdown-menu&gt;</span><br><span class="line">        &lt;/el-dropdown&gt;</span><br><span class="line">        &lt;el-link &gt;视频讲解&lt;/el-link&gt;</span><br><span class="line">        &lt;el-link&gt;公众号&lt;/el-link&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/el-header&gt;</span><br><span class="line">...</span><br><span class="line">data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        userInfo: &#123;</span><br><span class="line">            id: &#x27;&#x27;,</span><br><span class="line">            username: &#x27;&#x27;,</span><br><span class="line">            avatar: &#x27;&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">created() &#123;</span><br><span class="line">    this.getUserInfo()</span><br><span class="line">&#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">    getUserInfo() &#123;</span><br><span class="line">        this.$axios.get(&quot;/sys/userInfo&quot;).then(res =&gt; &#123;</span><br><span class="line">            this.userInfo = res.data.data;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    logout() &#123;</span><br><span class="line">        this.$axios.post(&quot;/logout&quot;).then(res =&gt; &#123;</span><br><span class="line">            console.log(res.data.data)</span><br><span class="line">            localStorage.clear()</span><br><span class="line">            sessionStorage.clear()</span><br><span class="line">            this.$store.commit(&quot;resetState&quot;)</span><br><span class="line">            this.$router.push(&quot;/login&quot;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>记得mockjs中返回用户的信息，比较简单我就不写了这个。</p>
<h2 id="9-动态菜单栏开发"><a href="#9-动态菜单栏开发" class="headerlink" title="9. 动态菜单栏开发"></a>9. 动态菜单栏开发</h2><p>上面代码中，左侧的菜单栏的数据是写死的，在实际场景中我们不可能这样做，因为菜单是需要根据登录用户的权限动态显示菜单的，也就是用户看到的菜单栏可能是不一样的，这些数据需要去后端访问获取。</p>
<p>首先我们先把写死的数据简化成一个json数组数据，然后for循环展示出来，代码如下：</p>
<ul>
<li>/src/views/inc/SideMenu.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;el-menu</span><br><span class="line">            class=&quot;el-menu-vertical-demo&quot;</span><br><span class="line">            background-color=&quot;#545c64&quot;</span><br><span class="line">            text-color=&quot;#fff&quot;</span><br><span class="line">            active-text-color=&quot;#ffd04b&quot;</span><br><span class="line">    &gt;</span><br><span class="line">        ...</span><br><span class="line">        &lt;el-submenu default-active=&quot;Index&quot; :index=&quot;menu.name&quot; v-for=&quot;menu in menuList&quot;&gt;</span><br><span class="line">            &lt;template slot=&quot;title&quot;&gt;</span><br><span class="line">                &lt;i :class=&quot;menu.icon&quot;&gt;&lt;/i&gt;</span><br><span class="line">                &lt;span&gt;&#123;&#123;menu.title&#125;&#125;&lt;/span&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">            &lt;router-link :to=&quot;item.path&quot; v-for=&quot;item in menu.children&quot;&gt;</span><br><span class="line">                &lt;el-menu-item :index=&quot;item.name&quot;&gt;</span><br><span class="line">                    &lt;template slot=&quot;title&quot;&gt;</span><br><span class="line">                        &lt;i :class=&quot;item.icon&quot;&gt;&lt;/i&gt;</span><br><span class="line">                        &lt;span slot=&quot;title&quot;&gt;&#123;&#123;item.title&#125;&#125;&lt;/span&gt;</span><br><span class="line">                    &lt;/template&gt;</span><br><span class="line">                &lt;/el-menu-item&gt;</span><br><span class="line">            &lt;/router-link&gt;</span><br><span class="line">        &lt;/el-submenu&gt;</span><br><span class="line">    &lt;/el-menu&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">    export default &#123;</span><br><span class="line">        name: &quot;SideMenu&quot;,</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                menuList: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        name: &#x27;SysManga&#x27;,</span><br><span class="line">                        title: &#x27;系统管理&#x27;,</span><br><span class="line">                        icon: &#x27;el-icon-s-operation&#x27;,</span><br><span class="line">                        path: &#x27;&#x27;,</span><br><span class="line">                        component: &#x27;&#x27;,</span><br><span class="line">                        children: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                name: &#x27;SysUser&#x27;,</span><br><span class="line">                                title: &#x27;用户管理&#x27;,</span><br><span class="line">                                icon: &#x27;el-icon-s-custom&#x27;,</span><br><span class="line">                                path: &#x27;/sys/users&#x27;,</span><br><span class="line">                                children: []</span><br><span class="line">                            &#125;</span><br><span class="line">                        ]</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        name: &#x27;SysTools&#x27;,</span><br><span class="line">                        title: &#x27;系统工具&#x27;,</span><br><span class="line">                        icon: &#x27;el-icon-s-tools&#x27;,</span><br><span class="line">                        path: &#x27;&#x27;,</span><br><span class="line">                        children: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                name: &#x27;SysDict&#x27;,</span><br><span class="line">                                title: &#x27;数字字典&#x27;,</span><br><span class="line">                                icon: &#x27;el-icon-s-order&#x27;,</span><br><span class="line">                                path: &#x27;/sys/dicts&#x27;,</span><br><span class="line">                                children: []</span><br><span class="line">                            &#125;,</span><br><span class="line">                        ]</span><br><span class="line">                    &#125;</span><br><span class="line">                ],</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，我用for循环显示数据，那么这样变动菜单栏时候只需要修改data中的menuList即可。效果和之前的完全一样。<br>现在menuList的数据我们是直接写到页面data上的，一般我们是要请求后端的，所以这里我们定义一个mock接口，因为是动态菜单，一般我们也要考虑到权限问题，所以我们请求数据的时候一般除了动态菜单，还要权限的数据，比如菜单的添加、删除是否有权限，是否能显示该按钮等，有了权限数据我们就定动态决定是否展示这些按钮了。</p>
<ul>
<li>src/mock.js</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Mock.mock(&#x27;/sys/menu/nav&#x27;, &#x27;get&#x27;, () =&gt; &#123;</span><br><span class="line">   // 菜单json</span><br><span class="line">   let nav = [</span><br><span class="line">      &#123;</span><br><span class="line">         name: &#x27;SysManga&#x27;,</span><br><span class="line">         ...</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         name: &#x27;SysTools&#x27;,</span><br><span class="line">         ...</span><br><span class="line">      &#125;</span><br><span class="line">   ]</span><br><span class="line">   // 权限数据</span><br><span class="line">   let authoritys = [&#x27;SysUser&#x27;, &quot;SysUser:save&quot;]</span><br><span class="line"></span><br><span class="line">   Result.data = &#123;&#125;</span><br><span class="line">   Result.data.nav = nav</span><br><span class="line">   Result.data.authoritys = authoritys</span><br><span class="line">   return Result</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>上面json数据太长，所以我部分用省略号…替代了，以后的代码也会这样哈。<br>这样我们就定义好了导航菜单的接口，什么时候调用呢？应该登录成功完成之后调用，但是并不是每一次打开我们都需要去登录，也就是浏览器已经存储到用户token的时候我们不需要再去登录的了，所以我们不能放在登录完成的方法里。那么是当前这个Home.vue页面吗？看起来没什么问题，方正每次都会进入这个页面，然后搞个开关控制是否重新加载就行？</p>
<p>我们这里还要考虑一个问题，就是导航菜单的路由问题，啥意思？就是点击菜单之后路由到哪个页面是需要在router中声明的。</p>
<p>这个路由问题我提供两个解决方案：</p>
<ul>
<li>1、全部写死，也就是提前写好所有的路由，不管用户有没有权限，后面在通过权限数据来判断用户是否有权限访问路由。</li>
<li>2、动态渲染，就是把加载到的导航菜单数据动态绑定路由</li>
</ul>
<p>这里我们使用第二种解决方案，这类简单点，后续我们再开发页面的时候就不需要去改动路由，可以动态绑定。</p>
<p>综上，我们把加载菜单数据这个动作放在router.js中。Router有个前缀拦截，就是在路由到页面之前我们可以做一些判断或者加载数据。</p>
<p>在router.js中添加一下代码：</p>
<ul>
<li>src/router/index.js</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> hasRoute = store.state.menus.hasRoute</span><br><span class="line">  <span class="keyword">let</span> menus = store.state.menus.menuList</span><br><span class="line">  <span class="keyword">let</span> token = <span class="built_in">localStorage</span>.getItem(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">  <span class="keyword">if</span> (to.path == <span class="string">&#x27;/login&#x27;</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;login!!!!!!!!!!!&quot;</span>)</span><br><span class="line">    next()</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!token) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;还没有token！！！&quot;</span>)</span><br><span class="line">    next(&#123;<span class="attr">path</span>: <span class="string">&quot;/login&quot;</span>&#125;)</span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span> (to.path == <span class="string">&#x27;/&#x27;</span> || to.path == <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    next(&#123;<span class="attr">path</span>: <span class="string">&quot;/index&quot;</span>&#125;)</span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span> (!hasRoute) &#123;</span><br><span class="line">    <span class="keyword">let</span> newRoutes = router.options.routes;</span><br><span class="line">    axios.get(<span class="string">&quot;/sys/menu/nav&quot;</span>, &#123;<span class="attr">headers</span>:&#123;</span><br><span class="line">        <span class="attr">Authorization</span>: <span class="built_in">localStorage</span>.getItem(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">      &#125;&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(res.data.data)</span><br><span class="line">      store.commit(<span class="string">&quot;setMenuList&quot;</span>, res.data.data.nav)</span><br><span class="line">      store.commit(<span class="string">&quot;setPermList&quot;</span>, res.data.data.authoritys)</span><br><span class="line">      res.data.data.nav.forEach(<span class="function"><span class="params">menu</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (menu.children) &#123;</span><br><span class="line">          menu.children.forEach(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> route = menuToRoute(e)</span><br><span class="line">            <span class="keyword">if</span>(route) &#123;</span><br><span class="line">              newRoutes[<span class="number">0</span>].children.push(route)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;oldRoutes---------------&quot;</span>)</span><br><span class="line">      <span class="built_in">console</span>.log(newRoutes)</span><br><span class="line">      router.addRoutes(newRoutes)</span><br><span class="line">      store.commit(<span class="string">&quot;changeRouteStatus&quot;</span>, <span class="literal">true</span>)</span><br><span class="line">      next(&#123;<span class="attr">path</span>: to.path&#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;已经有路由了------------&quot;</span>)</span><br><span class="line">    next()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> menuToRoute = <span class="function">(<span class="params">menu</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;正在添加menu--》&quot;</span>)</span><br><span class="line">  <span class="built_in">console</span>.log(menu)</span><br><span class="line">  <span class="keyword">if</span> (!menu.component) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 复制属性</span></span><br><span class="line">  <span class="keyword">let</span> route = &#123;</span><br><span class="line">    <span class="attr">name</span>: menu.name,</span><br><span class="line">    <span class="attr">path</span>: menu.path,</span><br><span class="line">    <span class="attr">meta</span>: &#123;</span><br><span class="line">      <span class="attr">icon</span>: menu.icon,</span><br><span class="line">      <span class="attr">title</span>: menu.title</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  route.component = <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/&#x27;</span> + menu.component +<span class="string">&#x27;.vue&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> route</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>

<p>可以看到，我们通过menuToRoute就是把menu数据转换成路由对象，然后router.addRoutes(newRoutes)动态添加路由对象。<br>同时上面的menu对象中，有个menu.component，这个就是连接对应的组件，我们需要添加上去，比如说/sys/users链接对应到component(sys/User)。这样我们才能绑定添加到路由。所以我会修改mock中的nav的数据成这样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">let nav = [</span><br><span class="line">   &#123;</span><br><span class="line">      &quot;id&quot;: 1,</span><br><span class="line">      &quot;title&quot;: &quot;系统管理&quot;,</span><br><span class="line">      &quot;icon&quot;: &quot;el-icon-s-operation&quot;,</span><br><span class="line">      &quot;path&quot;: &quot;&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;sys:manage&quot;,</span><br><span class="line">      &quot;component&quot;: &quot;&quot;,</span><br><span class="line">      &quot;children&quot;: [</span><br><span class="line">         &#123;</span><br><span class="line">            &quot;id&quot;: 2,</span><br><span class="line">            &quot;title&quot;: &quot;用户管理&quot;,</span><br><span class="line">            &quot;icon&quot;: &quot;el-icon-s-custom&quot;,</span><br><span class="line">            &quot;path&quot;: &quot;/sys/users&quot;,</span><br><span class="line">            &quot;name&quot;: &quot;sys:user:list&quot;,</span><br><span class="line">            &quot;component&quot;: &quot;sys/User&quot;,</span><br><span class="line">            &quot;children&quot;: []</span><br><span class="line">         &#125;,</span><br><span class="line">         &#123;</span><br><span class="line">            &quot;id&quot;: 3,</span><br><span class="line">            &quot;title&quot;: &quot;角色管理&quot;,</span><br><span class="line">            &quot;icon&quot;: &quot;el-icon-rank&quot;,</span><br><span class="line">            &quot;path&quot;: &quot;/sys/roles&quot;,</span><br><span class="line">            &quot;name&quot;: &quot;sys:role:list&quot;,</span><br><span class="line">            &quot;component&quot;: &quot;sys/Role&quot;,</span><br><span class="line">            &quot;children&quot;: []</span><br><span class="line">         &#125;,</span><br><span class="line">         &#123;</span><br><span class="line">            &quot;id&quot;: 4,</span><br><span class="line">            &quot;title&quot;: &quot;菜单管理&quot;,</span><br><span class="line">            &quot;icon&quot;: &quot;el-icon-menu&quot;,</span><br><span class="line">            &quot;path&quot;: &quot;/sys/menus&quot;,</span><br><span class="line">            &quot;name&quot;: &quot;sys:menu:list&quot;,</span><br><span class="line">            &quot;component&quot;: &quot;sys/Menu&quot;,</span><br><span class="line">            &quot;children&quot;: []</span><br><span class="line">         &#125;</span><br><span class="line">      ]</span><br><span class="line">   &#125;,</span><br><span class="line">   &#123;</span><br><span class="line">      &quot;id&quot;: 5,</span><br><span class="line">      &quot;title&quot;: &quot;系统工具&quot;,</span><br><span class="line">      &quot;icon&quot;: &quot;el-icon-s-tools&quot;,</span><br><span class="line">      &quot;path&quot;: &quot;&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;sys:tools&quot;,</span><br><span class="line">      &quot;component&quot;: null,</span><br><span class="line">      &quot;children&quot;: [</span><br><span class="line">         &#123;</span><br><span class="line">            &quot;id&quot;: 6,</span><br><span class="line">            &quot;title&quot;: &quot;数字字典&quot;,</span><br><span class="line">            &quot;icon&quot;: &quot;el-icon-s-order&quot;,</span><br><span class="line">            &quot;path&quot;: &quot;/sys/dicts&quot;,</span><br><span class="line">            &quot;name&quot;: &quot;sys:dict:list&quot;,</span><br><span class="line">            &quot;component&quot;: &quot;sys/Dict&quot;,</span><br><span class="line">            &quot;children&quot;: []</span><br><span class="line">         &#125;</span><br><span class="line">      ]</span><br><span class="line">   &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>同时上面router中我们还通过判断是否登录页面，是否有token等判断提前判断是否能加载菜单，同时还做了个开关hasRoute来动态判断是否已经加载过菜单。</p>
<p>还需要在store中定义几个方法用于存储数据，我们定义一个menu模块，所以在store中新建文件夹modules，然后新建menus.js</p>
<ul>
<li>src/store/modules/menus.js</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &#x27;vue&#x27;</span><br><span class="line">import Vuex from &#x27;vuex&#x27;</span><br><span class="line">Vue.use(Vuex)</span><br><span class="line">export default &#123;</span><br><span class="line">   state: &#123;</span><br><span class="line">      // 菜单栏数据</span><br><span class="line">      menuList:  [],</span><br><span class="line">      // 权限数据</span><br><span class="line">      permList:  [],</span><br><span class="line">      hasRoute: false</span><br><span class="line">   &#125;,</span><br><span class="line">   mutations: &#123;</span><br><span class="line">      changeRouteStatus(state, hasRoute) &#123;</span><br><span class="line">         state.hasRoute = hasRoute</span><br><span class="line">         sessionStorage.setItem(&quot;hasRoute&quot;, hasRoute)</span><br><span class="line">      &#125;,</span><br><span class="line">      setMenuList(state, menus) &#123;</span><br><span class="line">         state.menuList = menus</span><br><span class="line">      &#125;,</span><br><span class="line">      setPermList(state, authoritys) &#123;</span><br><span class="line">         state.permList = authoritys</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>记得在store中import这个模块，然后添加到modules：</p>
<ul>
<li><p>src/store/index.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import menus from &quot;./modules/menus&quot;</span><br><span class="line">...</span><br><span class="line">export default new Vuex.Store(&#123;</span><br><span class="line">...</span><br><span class="line">modules: &#123;</span><br><span class="line">  menus</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>这样我们菜单的数据就可以加载了，然后再SideMenu.vue中直接获取store中的menuList数据即可显示菜单出来了。</p>
</li>
<li><p>src/views/inc/SideMenu.vue</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        menuList: this.$store.state.menus.menuList,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后效果如下：<br><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/489f7ce2ede747558206a6d533bdd3a2.png" alt="图片"></p>
<p>好了，好像已经有点完善了哈哈。</p>
<h2 id="10-动态标签页开发"><a href="#10-动态标签页开发" class="headerlink" title="10. 动态标签页开发"></a>10. 动态标签页开发</h2><p>上面做完之后，总还觉得少点什么，对了标签页，我看别的后台管理系统都有这个，效果是这样的：</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/2c6ed79157c34f3d873e5a0a6831b91c.png" alt="图片"></p>
<p>搞起搞起，别人有我不能没有，于是我去element-ui中寻了一圈，发现Tab标签页组件挺符合我们要求的，可以动态增减标签页。</p>
<p>理想的动作是这样的：</p>
<ol>
<li>当我们点击导航菜单，上方会添加一个对应的标签，注意不能重复添加，发现已存在标签直接切换到这标签即可</li>
<li>删除当前标签的时候会自动切换到前一个标签页</li>
<li>点击标签页的时候会调整到对应的内容页中</li>
</ol>
<p>综合Vue的思想，我们可以这样设计：在Store中统一存储：1、当前标签Tab，2、已存在的标签Tab列表，然后页面从Store中获取列表显示，并切换到当前Tab即可。删除时候我们循环当前Tab列表，剔除Tab，并切换到指定Tab。</p>
<p>我们先和左侧菜单一样单独定义一个组件Tabs.vue放在views/inc文件夹内：</p>
<ul>
<li>src/views/inc/Tabs.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;el-tabs v-model=&quot;editableTabsValue&quot; type=&quot;card&quot; closable @tab-remove=&quot;removeTab&quot; @tab-click=&quot;clickTab&quot;&gt;</span><br><span class="line">        &lt;el-tab-pane</span><br><span class="line">                v-for=&quot;item in editableTabs&quot;</span><br><span class="line">                :key=&quot;item.name&quot;</span><br><span class="line">                :label=&quot;item.title&quot;</span><br><span class="line">                :name=&quot;item.name&quot;</span><br><span class="line">        &gt;</span><br><span class="line">        &lt;/el-tab-pane&gt;</span><br><span class="line">    &lt;/el-tabs&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">    export default &#123;</span><br><span class="line">        name: &quot;Tabs&quot;,</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        computed: &#123;</span><br><span class="line">            editableTabs: &#123;</span><br><span class="line">                get() &#123;</span><br><span class="line">                    return this.$store.state.menus.editableTabs;</span><br><span class="line">                &#125;,</span><br><span class="line">                set(val) &#123;</span><br><span class="line">                    this.$store.state.menus.editableTabs = val</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            editableTabsValue: &#123;</span><br><span class="line">                get() &#123;</span><br><span class="line">                    return this.$store.state.menus.editableTabsValue;</span><br><span class="line">                &#125;,</span><br><span class="line">                set(val) &#123;</span><br><span class="line">                    this.$store.state.menus.editableTabsValue = val;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            clickTab(target) &#123;</span><br><span class="line">                this.$router.push(&#123;name: target.name&#125;)</span><br><span class="line">            &#125;,</span><br><span class="line">            removeTab(targetName) &#123;</span><br><span class="line">                let tabs = this.editableTabs;</span><br><span class="line">                let activeName = this.editableTabsValue;</span><br><span class="line">                // 首页不能删除</span><br><span class="line">                if (targetName === &quot;Index&quot;) &#123;</span><br><span class="line">                    return</span><br><span class="line">                &#125;</span><br><span class="line">                if (activeName === targetName) &#123;</span><br><span class="line">                    tabs.forEach((tab, index) =&gt; &#123;</span><br><span class="line">                        if (tab.name === targetName) &#123;</span><br><span class="line">                            let nextTab = tabs[index + 1] || tabs[index - 1];</span><br><span class="line">                            if (nextTab) &#123;</span><br><span class="line">                                activeName = nextTab.name;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">                this.editableTabsValue = activeName;</span><br><span class="line">                this.editableTabs = tabs.filter(tab =&gt; tab.name !== targetName);</span><br><span class="line">                this.$router.push(&#123;name: activeName&#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>上面代码中，computed表示当其依赖的属性的值发生变化时，计算属性会重新计算，反之，则使用缓存中的属性值。这样我们就可以实时监测Tabs标签的动态变化实时显示（相当于实时get、set）。其他clickTab、removeTab的逻辑其实也还算简单，特别是removeTab注意考虑多种情况就可以。<br>然后我们来到store中的menu.js，我们添加 editableTabsValue和editableTabs，然后把首页作为默认显示的页面。</p>
<ul>
<li>src/store/modules/menus.js</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">state: &#123;</span><br><span class="line">   // 菜单栏数据</span><br><span class="line">   menuList:  [],</span><br><span class="line">   // 权限数据</span><br><span class="line">   permList:  [],</span><br><span class="line">   hasRoute: false,</span><br><span class="line"></span><br><span class="line">   editableTabsValue: &#x27;Index&#x27;,</span><br><span class="line">   editableTabs: [</span><br><span class="line">      &#123;</span><br><span class="line">         title: &#x27;首页&#x27;,</span><br><span class="line">         name: &#x27;Index&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">   ],</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>ok，然后再Home.vue中引入我们Tabs.vue这个组件，添加代码的地方比较零散，所以我就写重要代码出来就好，自行添加到指定的地方哈。</p>
<ul>
<li>src/views/Home.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 引入组件</span><br><span class="line">import Tabs from &quot;./inc/Tabs&quot;</span><br><span class="line"># 声明组件</span><br><span class="line">components: &#123;</span><br><span class="line">   SideMenu, Tabs</span><br><span class="line">&#125;,</span><br><span class="line">&lt;el-main&gt;</span><br><span class="line">   # 使用组件</span><br><span class="line">   &lt;Tabs&gt;&lt;/Tabs&gt;</span><br><span class="line">   &lt;div style=&quot;margin: 0 15px;&quot;&gt;</span><br><span class="line">      &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">&lt;/el-main&gt;</span><br></pre></td></tr></table></figure>

<p>最后效果如下：<br><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/a810bca0141c4514a51f73ef3b9f1092.png" alt="图片"></p>
<p>好了完成了第一步了，现在我们需要点击菜单导航，然后再tabs列表中添加tab标签页，那么我们来到SideMenu.vue，我们给el-menu-item每个菜单都添加一个点击事件：</p>
<ul>
<li>src/views/inc/SideMenu.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-menu</span><br><span class="line">        # 当前选择的菜单</span><br><span class="line">        :default-active=&quot;activeMenu&quot;</span><br><span class="line">        ...</span><br><span class="line">&gt;</span><br><span class="line">...</span><br><span class="line">&lt;router-link :to=&quot;item.path&quot; v-for=&quot;item in menu.children&quot;&gt;</span><br><span class="line">    &lt;el-menu-item :index=&quot;item.name&quot; @click=&quot;selectMenu(item)&quot;&gt;</span><br><span class="line">        ...</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">&lt;/router-link&gt;</span><br><span class="line">computed: &#123;</span><br><span class="line">    # 选择tab标签时候顺便也要激活当前对应的导航</span><br><span class="line">    activeMenu() &#123;</span><br><span class="line">        return this.$store.state.menus.editableTabsValue</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">    selectMenu(item) &#123;</span><br><span class="line">        console.log(item)</span><br><span class="line">        let obj = &#123;</span><br><span class="line">            name: item.name,</span><br><span class="line">            title: item.title</span><br><span class="line">        &#125;</span><br><span class="line">        this.$store.commit(&quot;addTabs&quot;, obj)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因为tabs标签列表我们是存储在store中的，因此我们需要commit提交事件，因此我们在menu.js中添加addTabs方法：</p>
<ul>
<li>src/store/modules/menus.js</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mutations: &#123;</span><br><span class="line">   addTabs(state, tab) &#123;</span><br><span class="line">      console.log(tab)</span><br><span class="line">      // 判断是否在栈内</span><br><span class="line">      let index = state.editableTabs.findIndex(item =&gt; item.name === tab.name)</span><br><span class="line">      if (index === -1) &#123;</span><br><span class="line">         // 添加到tabs中</span><br><span class="line">         state.editableTabs.push(tab)</span><br><span class="line">      &#125;</span><br><span class="line">      // 当前激活的tab</span><br><span class="line">      state.editableTabsValue = tab.name</span><br><span class="line">   &#125;,</span><br><span class="line">   setActiveTab(state, tabName) &#123;</span><br><span class="line">      state.editableTabsValue = tabName</span><br><span class="line">   &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>添加tab标签的时候注意需要激活指定当前标签，也就是设置editableTabsValue。然后我们也添加了setActiveTab方法，方便其他地方指定激活某个标签。<br>具体效果如下：</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/baeac050efb74aeaa42c952622b10e90.png" alt="图片"></p>
<p>上面的演示看似没什么问题了，但其实细节还是很多的，比如当我们刷新浏览器、或者直接通过输入链接打开页面时候就不会自动帮我们根据链接回显激活Tab。</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/d3c6d54548af4277a89f63c2215b9a4f.png" alt="图片"></p>
<p>从上面图中我们可以看出刷新浏览器之后链接/sys/users不变，内容不变，但是Tab却不见了，所以我们需要修补一下，当用户是直接通过输入链接形式打开页面的时候我们也能根据链接自动添加激活指定的tab。那么在哪里添加这个回显的方法呢？router中？其实可以，只不过我们需要做判断，因为每次点击导航都会触发router。有没有更简便的方法？有的！因为刷新或者打开页面都是一次性的行为，所以我们可以在更高层的App.vue中做这个回显动作，具体如下：</p>
<ul>
<li>src\App.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">      &lt;router-view/&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">   export default &#123;</span><br><span class="line">      name: &quot;App&quot;,</span><br><span class="line">      watch: &#123;</span><br><span class="line">         // 解决刷新浏览器没有tab的问题</span><br><span class="line">         $route(to, from) &#123;</span><br><span class="line">            if (to.path != &#x27;/login&#x27;) &#123;</span><br><span class="line">               let obj = &#123;</span><br><span class="line">                  name: to.name,</span><br><span class="line">                  title: to.meta.title</span><br><span class="line">               &#125;</span><br><span class="line">               this.$store.commit(&quot;addTabs&quot;, obj)</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>上面代码可以看到，除了login页面，其他页面都会触发addTabs方法，这样我们就可以添加tab和激活tab了。<br><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/2f58687373634ce9b0f6ce024dfb90dc.png" alt="图片"></p>
<p>完美搞定！</p>
<h2 id="11-个人中心"><a href="#11-个人中心" class="headerlink" title="11. 个人中心"></a>11. 个人中心</h2><p>个人中心用来展示用户的基本信息和修改密码，相对简单：</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/e34b3709551f49bc88f91967c02cb2d7.png" alt="图片"></p>
<ul>
<li>src/views/UserCenter.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;div style=&quot;text-align: center;&quot;&gt;</span><br><span class="line">      &lt;h2&gt;你好！&#123;&#123; userInfo.username &#125;&#125; 同学&lt;/h2&gt;</span><br><span class="line">      &lt;el-form :model=&quot;passForm&quot; status-icon :rules=&quot;rules&quot; ref=&quot;passForm&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">         &lt;el-form-item label=&quot;旧密码&quot; prop=&quot;currentPass&quot;&gt;</span><br><span class="line">            &lt;el-input type=&quot;password&quot; v-model=&quot;passForm.currentPass&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">         &lt;/el-form-item&gt;</span><br><span class="line">         &lt;el-form-item label=&quot;新密码&quot; prop=&quot;password&quot;&gt;</span><br><span class="line">            &lt;el-input type=&quot;password&quot; v-model=&quot;passForm.password&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">         &lt;/el-form-item&gt;</span><br><span class="line">         &lt;el-form-item label=&quot;确认密码&quot; prop=&quot;checkPass&quot;&gt;</span><br><span class="line">            &lt;el-input type=&quot;password&quot; v-model=&quot;passForm.checkPass&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">         &lt;/el-form-item&gt;</span><br><span class="line">         &lt;el-form-item&gt;</span><br><span class="line">            &lt;el-button type=&quot;primary&quot; @click=&quot;submitForm(&#x27;passForm&#x27;)&quot;&gt;提交&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button @click=&quot;resetForm(&#x27;passForm&#x27;)&quot;&gt;重置&lt;/el-button&gt;</span><br><span class="line">         &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">   export default &#123;</span><br><span class="line">      name: &quot;Login&quot;,</span><br><span class="line">      data() &#123;</span><br><span class="line">         var validatePass = (rule, value, callback) =&gt; &#123;</span><br><span class="line">            if (value === &#x27;&#x27;) &#123;</span><br><span class="line">               callback(new Error(&#x27;请再次输入密码&#x27;));</span><br><span class="line">            &#125; else if (value !== this.passForm.password) &#123;</span><br><span class="line">               callback(new Error(&#x27;两次输入密码不一致!&#x27;));</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">               callback();</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;;</span><br><span class="line">         return &#123;</span><br><span class="line">            userInfo: &#123;</span><br><span class="line">            &#125;,</span><br><span class="line">            passForm: &#123;</span><br><span class="line">               password: &#x27;111111&#x27;,</span><br><span class="line">               checkPass: &#x27;111111&#x27;,</span><br><span class="line">               currentPass: &#x27;111111&#x27;</span><br><span class="line">            &#125;,</span><br><span class="line">            rules: &#123;</span><br><span class="line">               password: [</span><br><span class="line">                  &#123; required: true, message: &#x27;请输入新密码&#x27;, trigger: &#x27;blur&#x27; &#125;,</span><br><span class="line">                  &#123; min: 6, max: 12, message: &#x27;长度在 6 到 12 个字符&#x27;, trigger: &#x27;blur&#x27; &#125;</span><br><span class="line">               ],</span><br><span class="line">               checkPass: [</span><br><span class="line">                  &#123; required: true, validator: validatePass, trigger: &#x27;blur&#x27; &#125;</span><br><span class="line">               ],</span><br><span class="line">               currentPass: [</span><br><span class="line">                  &#123; required: true, message: &#x27;请输入当前密码&#x27;, trigger: &#x27;blur&#x27; &#125;,</span><br><span class="line">               ]</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      created() &#123;</span><br><span class="line">         this.getUserInfo()</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">         getUserInfo() &#123;</span><br><span class="line">            this.$axios.get(&quot;/sys/userInfo&quot;).then(res =&gt; &#123;</span><br><span class="line">               this.userInfo = res.data.data;</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">         submitForm(formName) &#123;</span><br><span class="line">            this.$refs[formName].validate((valid) =&gt; &#123;</span><br><span class="line">               if (valid) &#123;</span><br><span class="line">                  const _this = this</span><br><span class="line">                  this.$axios.post(&#x27;/sys/user/updataPass&#x27;, this.passForm).then(res =&gt; &#123;</span><br><span class="line">                     _this.$alert(res.data.msg, &#x27;提示&#x27;, &#123;</span><br><span class="line">                        confirmButtonText: &#x27;确定&#x27;,</span><br><span class="line">                        callback: action =&gt; &#123;</span><br><span class="line">                           this.$refs[formName].resetFields();</span><br><span class="line">                        &#125;</span><br><span class="line">                     &#125;);</span><br><span class="line">                  &#125;)</span><br><span class="line">               &#125; else &#123;</span><br><span class="line">                  console.log(&#x27;error submit!!&#x27;);</span><br><span class="line">                  return false;</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">         &#125;,</span><br><span class="line">         resetForm(formName) &#123;</span><br><span class="line">            this.$refs[formName].resetFields();</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.el-form &#123;</span><br><span class="line">   width: 420px;</span><br><span class="line">   margin: 50px auto;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="12-菜单界面"><a href="#12-菜单界面" class="headerlink" title="12. 菜单界面"></a>12. 菜单界面</h2><p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/e539c20d93f84f7c8dae7c5785253605.png" alt="图片"></p>
<p>菜单管理我们用到了Table表格组件的树形结构数据，我们只需要根据例子自己组装数据，就可以自动显示出来了，在新增数据的时候有个地方需要讲一下：</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/4a051ee030ce44738ae9635b25b1c161.png" alt="图片"></p>
<p>这里本应该是个树形数据的结构，但是现有的elementui不是很满足，于是我就拿了个简单的下拉框，然后子菜单就加上一个【- 】作为前缀，这样看起来就像一个树形结构了，也比较清晰。具体代码如下：</p>
<ul>
<li>src/views/sys/Menu.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-form-item label=&quot;上级菜单&quot; prop=&quot;parentId&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">   &lt;!--模拟树形下拉框--&gt;</span><br><span class="line">   &lt;el-select v-model=&quot;editForm.parentId&quot; placeholder=&quot;请选择上级菜单&quot; &gt;</span><br><span class="line">      &lt;template v-for=&quot;item in tableData&quot;&gt;</span><br><span class="line">         &lt;el-option :label=&quot;item.name&quot; :value=&quot;item.id&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">         &lt;template v-for=&quot;child in item.children&quot;&gt;</span><br><span class="line">            &lt;el-option :label=&quot;child.name&quot; :value=&quot;child.id&quot;&gt;</span><br><span class="line">               &lt;span&gt;&#123;&#123; &#x27;- &#x27; + child.name &#125;&#125;&lt;/span&gt;</span><br><span class="line">            &lt;/el-option&gt;</span><br><span class="line">         &lt;/template&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">   &lt;/el-select&gt;</span><br><span class="line">&lt;/el-form-item&gt;</span><br></pre></td></tr></table></figure>

<p>其他都是基本的增删改查，填数据啥的，就比较繁琐和简单了，贴代码了哈：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;div&gt;</span><br><span class="line">      &lt;!--搜索框--&gt;</span><br><span class="line">      &lt;el-form :inline=&quot;true&quot; :model=&quot;searchForm&quot;&gt;</span><br><span class="line">         &lt;el-form-item&gt;</span><br><span class="line">            &lt;el-button type=&quot;primary&quot; @click=&quot;dialogFormVisible = true&quot; v-if=&quot;hasAuth(&#x27;sys:menu:save&#x27;)&quot;&gt;新增&lt;/el-button&gt;</span><br><span class="line">         &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">      &lt;!--列表--&gt;</span><br><span class="line">      &lt;el-table</span><br><span class="line">            :data=&quot;tableData&quot;</span><br><span class="line">            style=&quot;width: 100%;margin-bottom: 20px;&quot;</span><br><span class="line">            row-key=&quot;id&quot;</span><br><span class="line">            border</span><br><span class="line">            stripe</span><br><span class="line">            default-expand-all</span><br><span class="line">            :tree-props=&quot;&#123;children: &#x27;children&#x27;, hasChildren: &#x27;hasChildren&#x27;&#125;&quot;&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;name&quot;</span><br><span class="line">               label=&quot;名称&quot;</span><br><span class="line">               width=&quot;180&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;perms&quot;</span><br><span class="line">               label=&quot;权限编码&quot;</span><br><span class="line">               width=&quot;180&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;icon&quot;</span><br><span class="line">               label=&quot;图标&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;type&quot;</span><br><span class="line">               label=&quot;类型&quot;</span><br><span class="line">               width=&quot;120&quot;&gt;</span><br><span class="line">            &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">               &lt;el-tag v-if=&quot;scope.row.type === 0&quot; size=&quot;small&quot;&gt;目录&lt;/el-tag&gt;</span><br><span class="line">               &lt;el-tag v-else-if=&quot;scope.row.type === 1&quot; size=&quot;small&quot; type=&quot;success&quot;&gt;菜单&lt;/el-tag&gt;</span><br><span class="line">               &lt;el-tag v-else-if=&quot;scope.row.type === 2&quot; size=&quot;small&quot; type=&quot;info&quot;&gt;按钮&lt;/el-tag&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;path&quot;</span><br><span class="line">               label=&quot;菜单URL&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;component&quot;</span><br><span class="line">               label=&quot;菜单组件&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;orderNum&quot;</span><br><span class="line">               label=&quot;排序号&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;statu&quot;</span><br><span class="line">               label=&quot;状态&quot;</span><br><span class="line">               width=&quot;120&quot;&gt;</span><br><span class="line">            &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">               &lt;el-tag v-if=&quot;scope.row.statu === 0&quot; size=&quot;small&quot; type=&quot;danger&quot;&gt;禁用&lt;/el-tag&gt;</span><br><span class="line">               &lt;el-tag v-else-if=&quot;scope.row.statu === 1&quot; size=&quot;small&quot; type=&quot;success&quot;&gt;正常&lt;/el-tag&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               label=&quot;操作&quot;</span><br><span class="line">               width=&quot;120&quot;&gt;</span><br><span class="line">            &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">               &lt;el-button type=&quot;text&quot; @click=&quot;editHandle(scope.row.id)&quot; v-if=&quot;hasAuth(&#x27;sys:menu:update&#x27;)&quot;&gt;编辑&lt;/el-button&gt;</span><br><span class="line">               &lt;el-divider direction=&quot;vertical&quot;&gt;&lt;/el-divider&gt;</span><br><span class="line">               &lt;el-popconfirm title=&quot;确定要删除这条记录吗？&quot; @confirm=&quot;delHandle(scope.row.id)&quot; v-if=&quot;hasAuth(&#x27;sys:menu:delete&#x27;)&quot;&gt;</span><br><span class="line">                  &lt;el-button type=&quot;text&quot; slot=&quot;reference&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">               &lt;/el-popconfirm&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">      &lt;/el-table&gt;</span><br><span class="line">      &lt;el-dialog title=&quot;菜单信息&quot; :visible.sync=&quot;dialogFormVisible&quot; width=&quot;600px&quot; @closed=&quot;resetForm(&#x27;editForm&#x27;)&quot;&gt;</span><br><span class="line">         &lt;el-form :model=&quot;editForm&quot; :rules=&quot;editFormRules&quot; ref=&quot;editForm&quot;&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;上级菜单&quot; prop=&quot;parentId&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;!--模拟树形下拉框--&gt;</span><br><span class="line">               &lt;el-select v-model=&quot;editForm.parentId&quot; placeholder=&quot;请选择上级菜单&quot; &gt;</span><br><span class="line">                  &lt;template v-for=&quot;item in tableData&quot;&gt;</span><br><span class="line">                     &lt;el-option :label=&quot;item.name&quot; :value=&quot;item.id&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">                     &lt;template v-for=&quot;child in item.children&quot;&gt;</span><br><span class="line">                        &lt;el-option :label=&quot;child.name&quot; :value=&quot;child.id&quot;&gt;</span><br><span class="line">                           &lt;span&gt;&#123;&#123; &#x27;- &#x27; + child.name &#125;&#125;&lt;/span&gt;</span><br><span class="line">                        &lt;/el-option&gt;</span><br><span class="line">                     &lt;/template&gt;</span><br><span class="line">                  &lt;/template&gt;</span><br><span class="line">               &lt;/el-select&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;菜单名称&quot; prop=&quot;name&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;editForm.name&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;权限编码&quot; prop=&quot;perms&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;editForm.perms&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;图标&quot; prop=&quot;icon&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;editForm.icon&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;菜单URL&quot; prop=&quot;path&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;editForm.path&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;菜单组件&quot; prop=&quot;component&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;editForm.component&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;类型&quot; prop=&quot;type&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-radio-group v-model=&quot;editForm.type&quot;&gt;</span><br><span class="line">                  &lt;el-radio :label=0&gt;目录&lt;/el-radio&gt;</span><br><span class="line">                  &lt;el-radio :label=1&gt;菜单&lt;/el-radio&gt;</span><br><span class="line">                  &lt;el-radio :label=2&gt;按钮&lt;/el-radio&gt;</span><br><span class="line">               &lt;/el-radio-group&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;状态&quot; prop=&quot;statu&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-radio-group v-model=&quot;editForm.statu&quot;&gt;</span><br><span class="line">                  &lt;el-radio :label=0&gt;禁用&lt;/el-radio&gt;</span><br><span class="line">                  &lt;el-radio :label=1&gt;正常&lt;/el-radio&gt;</span><br><span class="line">               &lt;/el-radio-group&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;排序号&quot; prop=&quot;orderNum&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-input-number v-model=&quot;editForm.orderNum&quot; :min=&quot;1&quot; label=&quot;排序号&quot;&gt;1&lt;/el-input-number&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">         &lt;/el-form&gt;</span><br><span class="line">         &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">            &lt;el-button @click=&quot;resetForm(&#x27;editForm&#x27;)&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button type=&quot;primary&quot; @click=&quot;submitEditForm(&#x27;editForm&#x27;)&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">         &lt;/div&gt;</span><br><span class="line">      &lt;/el-dialog&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">   export default &#123;</span><br><span class="line">      name: &quot;Menu&quot;,</span><br><span class="line">      data() &#123;</span><br><span class="line">         return &#123;</span><br><span class="line">            searchForm: &#123;</span><br><span class="line">               name: &#x27;&#x27;</span><br><span class="line">            &#125;,</span><br><span class="line">            tableData: [],</span><br><span class="line">            multipleSelection: [],</span><br><span class="line">            dialogFormVisible: false,</span><br><span class="line">            editForm: &#123;</span><br><span class="line">            &#125;,</span><br><span class="line">            editFormRules: &#123;</span><br><span class="line">               parentId: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请选择上级菜单&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ],</span><br><span class="line">               name: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请输入名称&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ],</span><br><span class="line">               perms: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请输入权限编码&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ],</span><br><span class="line">               type: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请选择状态&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ],</span><br><span class="line">               orderNum: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请填入排序号&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ],</span><br><span class="line">               statu: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请选择状态&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ]</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">         getMenuTree() &#123;</span><br><span class="line">            this.$axios.get(&quot;/sys/menu/list&quot;, &#123;</span><br><span class="line">               params: &#123;</span><br><span class="line">                  name: this.searchForm.name</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;).then(res =&gt; &#123;</span><br><span class="line">               console.log(res)</span><br><span class="line">               this.tableData = res.data.data</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">         submitEditForm(formName) &#123;</span><br><span class="line">            this.$refs[formName].validate((valid) =&gt; &#123;</span><br><span class="line">               if (valid) &#123;</span><br><span class="line">                  this.$axios.post(&#x27;/sys/menu/&#x27; + (this.editForm.id? &quot;update&quot; : &quot;save&quot;) ,this.editForm)</span><br><span class="line">                     .then(res =&gt; &#123;</span><br><span class="line">                        console.log(res.data)</span><br><span class="line">                        this.resetForm(formName)</span><br><span class="line">                        this.$message(&#123;</span><br><span class="line">                           showClose: true,</span><br><span class="line">                           message: &#x27;恭喜你，操作成功&#x27;,</span><br><span class="line">                           type: &#x27;success&#x27;,</span><br><span class="line">                           onClose: () =&gt; &#123;</span><br><span class="line">                              this.getMenuTree()</span><br><span class="line">                           &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">                     &#125;)</span><br><span class="line">               &#125; else &#123;</span><br><span class="line">                  console.log(&#x27;error submit!!&#x27;);</span><br><span class="line">                  return false;</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">         &#125;,</span><br><span class="line">         editHandle(id) &#123;</span><br><span class="line">            console.log(id)</span><br><span class="line">            this.$axios.get(&quot;/sys/menu/info/&quot; + id).then(res =&gt; &#123;</span><br><span class="line">               this.editForm = res.data.data</span><br><span class="line">               this.dialogFormVisible = true</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">         delHandle(id) &#123;</span><br><span class="line">            this.$axios.post(&quot;/sys/menu/delete/&quot; + id).then(res =&gt; &#123;</span><br><span class="line">               console.log(res)</span><br><span class="line">               this.$message(&#123;</span><br><span class="line">                  showClose: true,</span><br><span class="line">                  message: &#x27;恭喜你，操作成功&#x27;,</span><br><span class="line">                  type: &#x27;success&#x27;,</span><br><span class="line">                  onClose: () =&gt; &#123;</span><br><span class="line">                     this.getMenuTree()</span><br><span class="line">                  &#125;</span><br><span class="line">               &#125;);</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">         resetForm(formName) &#123;</span><br><span class="line">            this.$refs[formName].resetFields();</span><br><span class="line">            this.editForm = &#123;&#125;</span><br><span class="line">            this.dialogFormVisible = false</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      created() &#123;</span><br><span class="line">         this.getMenuTree()</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h2 id="13-角色界面"><a href="#13-角色界面" class="headerlink" title="13. 角色界面"></a>13. 角色界面</h2><p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/1a741733072e413a96048d288d034070.png" alt="图片"></p>
<p>角色需要和菜单权限做关联，菜单是个树形结构的，</p>
<p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/e0d23d9422e94d3183bc969af3703ab1.png" alt="图片"></p>
<p>因为我们父节点是列表，所以注意不要选中父节点就自动选子节点，注意分开哈哈。</p>
<p>贴代码啦：</p>
<ul>
<li>src/views/sys/Role.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;div&gt;</span><br><span class="line">      &lt;!--搜索框--&gt;</span><br><span class="line">      &lt;el-form :inline=&quot;true&quot; :model=&quot;searchForm&quot; class=&quot;searchForm&quot;&gt;</span><br><span class="line">         &lt;el-form-item&gt;</span><br><span class="line">            &lt;el-input</span><br><span class="line">                  v-model=&quot;searchForm.name&quot;</span><br><span class="line">                  placeholder=&quot;名称&quot;</span><br><span class="line">                  clearable&gt;</span><br><span class="line">            &lt;/el-input&gt;</span><br><span class="line">         &lt;/el-form-item&gt;</span><br><span class="line">         &lt;el-form-item&gt;</span><br><span class="line">            &lt;el-button @click=&quot;getRoleList()&quot;&gt;搜索&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button type=&quot;primary&quot; @click=&quot;dialogFormVisible = true&quot; v-if=&quot;hasAuth(&#x27;sys:role:save&#x27;)&quot;&gt;新增&lt;/el-button&gt;</span><br><span class="line">            &lt;el-popconfirm title=&quot;确定要删除这些记录吗？&quot; @confirm=&quot;delHandle(null)&quot; style=&quot;margin-left: 10px;&quot; v-if=&quot;hasAuth(&#x27;sys:role:delete&#x27;)&quot;&gt;</span><br><span class="line">               &lt;el-button type=&quot;danger&quot; slot=&quot;reference&quot; :disabled=&quot;delBtnStu&quot;&gt;批量删除&lt;/el-button&gt;</span><br><span class="line">            &lt;/el-popconfirm&gt;</span><br><span class="line">         &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">      &lt;!--列表--&gt;</span><br><span class="line">      &lt;el-table</span><br><span class="line">            ref=&quot;multipleTable&quot;</span><br><span class="line">            border</span><br><span class="line">            stripe</span><br><span class="line">            :data=&quot;tableData&quot;</span><br><span class="line">            tooltip-effect=&quot;dark&quot;</span><br><span class="line">            style=&quot;width: 100%&quot;</span><br><span class="line">            @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               type=&quot;selection&quot;</span><br><span class="line">               width=&quot;55&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;name&quot;</span><br><span class="line">               label=&quot;名称&quot;</span><br><span class="line">               width=&quot;120&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;code&quot;</span><br><span class="line">               label=&quot;唯一编码&quot;</span><br><span class="line">               width=&quot;120&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;remark&quot;</span><br><span class="line">               label=&quot;描述&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;statu&quot;</span><br><span class="line">               label=&quot;状态&quot;</span><br><span class="line">               width=&quot;120&quot;&gt;</span><br><span class="line">            &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">               &lt;el-tag v-if=&quot;scope.row.statu === 0&quot; size=&quot;small&quot; type=&quot;danger&quot;&gt;禁用&lt;/el-tag&gt;</span><br><span class="line">               &lt;el-tag v-else-if=&quot;scope.row.statu === 1&quot; size=&quot;small&quot; type=&quot;success&quot;&gt;正常&lt;/el-tag&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               label=&quot;操作&quot;</span><br><span class="line">               width=&quot;220&quot;&gt;</span><br><span class="line">            &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">               &lt;el-button type=&quot;text&quot; @click=&quot;permHandle(scope.row.id)&quot; v-if=&quot;hasAuth(&#x27;sys:role:perm&#x27;)&quot;&gt;分配权限&lt;/el-button&gt;</span><br><span class="line">               &lt;el-divider direction=&quot;vertical&quot;&gt;&lt;/el-divider&gt;</span><br><span class="line">               &lt;el-button type=&quot;text&quot; @click=&quot;editHandle(scope.row.id)&quot; v-if=&quot;hasAuth(&#x27;sys:role:update&#x27;)&quot;&gt;编辑&lt;/el-button&gt;</span><br><span class="line">               &lt;el-divider direction=&quot;vertical&quot;&gt;&lt;/el-divider&gt;</span><br><span class="line">               &lt;el-popconfirm title=&quot;确定要删除这条记录吗？&quot; @confirm=&quot;delHandle(scope.row.id)&quot; v-if=&quot;hasAuth(&#x27;sys:role:delete&#x27;)&quot;&gt;</span><br><span class="line">                  &lt;el-button type=&quot;text&quot; slot=&quot;reference&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">               &lt;/el-popconfirm&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">      &lt;/el-table&gt;</span><br><span class="line">      &lt;!--页码--&gt;</span><br><span class="line">      &lt;el-pagination</span><br><span class="line">            @size-change=&quot;handleSizeChange&quot;</span><br><span class="line">            @current-change=&quot;handleCurrentChange&quot;</span><br><span class="line">            :current-page=&quot;current&quot;</span><br><span class="line">            :page-sizes=&quot;[10, 20, 50, 100]&quot;</span><br><span class="line">            :page-size=&quot;size&quot;</span><br><span class="line">            layout=&quot;total, sizes, prev, pager, next, jumper&quot;</span><br><span class="line">            :total=&quot;total&quot;&gt;</span><br><span class="line">      &lt;/el-pagination&gt;</span><br><span class="line">      &lt;!-- 编辑对话框 --&gt;</span><br><span class="line">      &lt;el-dialog title=&quot;角色信息&quot; :visible.sync=&quot;dialogFormVisible&quot; width=&quot;600px&quot; @closed=&quot;resetForm(&#x27;editForm&#x27;)&quot;&gt;</span><br><span class="line">         &lt;el-form :model=&quot;editForm&quot; :rules=&quot;editFormRules&quot; ref=&quot;editForm&quot;&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;角色名称&quot; prop=&quot;name&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;editForm.name&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;唯一编码&quot; prop=&quot;code&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;editForm.code&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;描述&quot; prop=&quot;remark&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;editForm.remark&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;状态&quot; prop=&quot;statu&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-radio-group v-model=&quot;editForm.statu&quot;&gt;</span><br><span class="line">                  &lt;el-radio :label=&quot;0&quot;&gt;禁用&lt;/el-radio&gt;</span><br><span class="line">                  &lt;el-radio :label=&quot;1&quot;&gt;正常&lt;/el-radio&gt;</span><br><span class="line">               &lt;/el-radio-group&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">         &lt;/el-form&gt;</span><br><span class="line">         &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">            &lt;el-button @click=&quot;resetForm(&#x27;editForm&#x27;)&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button type=&quot;primary&quot; @click=&quot;submitEditForm(&#x27;editForm&#x27;)&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">         &lt;/div&gt;</span><br><span class="line">      &lt;/el-dialog&gt;</span><br><span class="line">      &lt;!-- 分配权限对话框 --&gt;</span><br><span class="line">      &lt;el-dialog title=&quot;分配权限&quot; :visible.sync=&quot;permDialogFormVisible&quot; width=&quot;600px&quot; @closed=&quot;resetForm(&#x27;permForm&#x27;)&quot;&gt;</span><br><span class="line">         &lt;el-form :model=&quot;permForm&quot; ref=&quot;permForm&quot;&gt;</span><br><span class="line">            &lt;el-tree</span><br><span class="line">                  :data=&quot;permTreeData&quot;</span><br><span class="line">                  show-checkbox</span><br><span class="line">                  ref=&quot;permTree&quot;</span><br><span class="line">                  :check-strictly=checkStrictly</span><br><span class="line">                  node-key=&quot;id&quot;</span><br><span class="line">                  :default-expand-all=true</span><br><span class="line">                  :props=&quot;defaultProps&quot;&gt;</span><br><span class="line">            &lt;/el-tree&gt;</span><br><span class="line">         &lt;/el-form&gt;</span><br><span class="line">         &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">            &lt;el-button @click=&quot;resetForm(&#x27;permForm&#x27;)&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button type=&quot;primary&quot; @click=&quot;submitPermForm(&#x27;permForm&#x27;)&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">         &lt;/div&gt;</span><br><span class="line">      &lt;/el-dialog&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">   export default &#123;</span><br><span class="line">      name: &quot;Role&quot;,</span><br><span class="line">      data() &#123;</span><br><span class="line">         return &#123;</span><br><span class="line">            searchForm: &#123;</span><br><span class="line">               name: &#x27;&#x27;</span><br><span class="line">            &#125;,</span><br><span class="line">            tableData: [],</span><br><span class="line">            multipleSelection: [],</span><br><span class="line">            dialogFormVisible: false,</span><br><span class="line">            permDialogFormVisible: false,</span><br><span class="line">            delBtnStu: true,</span><br><span class="line">            current: 1,</span><br><span class="line">            total: 0,</span><br><span class="line">            size: 10,</span><br><span class="line">            editForm: &#123;</span><br><span class="line">            &#125;,</span><br><span class="line">            editFormRules: &#123;</span><br><span class="line">               name: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请输入名称&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ],</span><br><span class="line">               code: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请输入唯一编码&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ],</span><br><span class="line">               statu: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请选择状态&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ]</span><br><span class="line">            &#125;,</span><br><span class="line">            permForm: &#123;</span><br><span class="line">            &#125;,</span><br><span class="line">            defaultProps: &#123;</span><br><span class="line">               children: &#x27;children&#x27;,</span><br><span class="line">               label: &#x27;name&#x27;</span><br><span class="line">            &#125;,</span><br><span class="line">            permTreeData:  [],</span><br><span class="line">            treeCheckedKeys: [],</span><br><span class="line">            checkStrictly: true</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">         toggleSelection(rows) &#123;</span><br><span class="line">            if (rows) &#123;</span><br><span class="line">               rows.forEach(row =&gt; &#123;</span><br><span class="line">                  this.$refs.multipleTable.toggleRowSelection(row);</span><br><span class="line">               &#125;);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">               this.$refs.multipleTable.clearSelection();</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;,</span><br><span class="line">         handleSelectionChange(val) &#123;</span><br><span class="line">            this.multipleSelection = val;</span><br><span class="line">            this.delBtnStu = val.length == 0</span><br><span class="line">         &#125;,</span><br><span class="line">         getRoleList() &#123;</span><br><span class="line">            this.$axios.get(&#x27;/sys/role/list&#x27;, &#123;</span><br><span class="line">               params: &#123;</span><br><span class="line">                  name: this.searchForm.name,</span><br><span class="line">                  current: this.current,</span><br><span class="line">                  size: this.size</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;).then(res =&gt; &#123;</span><br><span class="line">               this.tableData = res.data.data.records</span><br><span class="line">               this.current = res.data.data.current</span><br><span class="line">               this.size = res.data.data.size</span><br><span class="line">               this.total = res.data.data.total</span><br><span class="line">               console.log(res)</span><br><span class="line">            &#125;)</span><br><span class="line">            this.$axios.get(&quot;/sys/menu/list&quot;).then(res =&gt; &#123;</span><br><span class="line">               this.permTreeData = res.data.data</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">         handleSizeChange(val) &#123;</span><br><span class="line">            this.size = val</span><br><span class="line">            this.getRoleList()</span><br><span class="line">         &#125;,</span><br><span class="line">         handleCurrentChange(val) &#123;</span><br><span class="line">            this.current = val</span><br><span class="line">            this.getRoleList()</span><br><span class="line">         &#125;,</span><br><span class="line">         submitEditForm(formName) &#123;</span><br><span class="line">            this.$refs[formName].validate((valid) =&gt; &#123;</span><br><span class="line">               if (valid) &#123;</span><br><span class="line">                  this.$axios.post(&#x27;/sys/role/&#x27; + (this.editForm.id? &quot;update&quot; : &quot;save&quot;) ,this.editForm)</span><br><span class="line">                     .then(res =&gt; &#123;</span><br><span class="line">                        console.log(res.data)</span><br><span class="line">                        this.resetForm(formName)</span><br><span class="line">                        this.$message(&#123;</span><br><span class="line">                           showClose: true,</span><br><span class="line">                           message: &#x27;恭喜你，操作成功&#x27;,</span><br><span class="line">                           type: &#x27;success&#x27;,</span><br><span class="line">                           onClose: () =&gt; &#123;</span><br><span class="line">                              this.getRoleList()</span><br><span class="line">                           &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">                     &#125;)</span><br><span class="line">               &#125; else &#123;</span><br><span class="line">                  console.log(&#x27;error submit!!&#x27;);</span><br><span class="line">                  return false;</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">         &#125;,</span><br><span class="line">         editHandle(id) &#123;</span><br><span class="line">            console.log(id)</span><br><span class="line">            this.$axios.get(&quot;/sys/role/info/&quot; + id).then(res =&gt; &#123;</span><br><span class="line">               this.editForm = res.data.data</span><br><span class="line">               this.dialogFormVisible = true</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">         delHandle(id) &#123;</span><br><span class="line">            console.log(id)</span><br><span class="line">            var ids = []</span><br><span class="line">            console.log(id ? 31:32)</span><br><span class="line">            id ? ids.push(id) : this.multipleSelection.forEach(row =&gt; &#123;</span><br><span class="line">               ids.push(row.id)</span><br><span class="line">            &#125;)</span><br><span class="line">            console.log(ids)</span><br><span class="line">            this.$axios.post(&quot;/sys/role/delete&quot;, ids).then(res =&gt; &#123;</span><br><span class="line">               console.log(res)</span><br><span class="line">               this.$message(&#123;</span><br><span class="line">                  showClose: true,</span><br><span class="line">                  message: &#x27;恭喜你，操作成功&#x27;,</span><br><span class="line">                  type: &#x27;success&#x27;,</span><br><span class="line">                  onClose: () =&gt; &#123;</span><br><span class="line">                     this.getRoleList()</span><br><span class="line">                  &#125;</span><br><span class="line">               &#125;);</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">         resetForm(formName) &#123;</span><br><span class="line">            this.$refs[formName].resetFields();</span><br><span class="line">            this.editForm = &#123;&#125;</span><br><span class="line">            this.dialogFormVisible = false</span><br><span class="line">            this.permDialogFormVisible = false</span><br><span class="line">         &#125;,</span><br><span class="line">         permHandle(id) &#123;</span><br><span class="line">            this.permDialogFormVisible = true</span><br><span class="line">            this.$axios.get(&quot;/sys/role/info/&quot; + id).then(res =&gt; &#123;</span><br><span class="line">               this.$refs.permTree.setCheckedKeys(res.data.data.menuIds);</span><br><span class="line">               this.permForm = res.data.data</span><br><span class="line">               console.log(&quot;this.treeCheckedKeys&quot;)</span><br><span class="line">               console.log(this.treeCheckedKeys)</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">         submitPermForm(formName) &#123;</span><br><span class="line">            var menuIds = []</span><br><span class="line">            menuIds = this.$refs.permTree.getCheckedKeys()</span><br><span class="line">            // menuIds = menuIds.concat(this.$refs.permTree.getHalfCheckedKeys()) // 半选中状态的父节点</span><br><span class="line">            console.log(menuIds)</span><br><span class="line">            console.log(this.permForm.id)</span><br><span class="line">            this.$axios.post(&quot;/sys/role/perm/&quot; + this.permForm.id, menuIds).then(res =&gt; &#123;</span><br><span class="line">               this.$message(&#123;</span><br><span class="line">                  showClose: true,</span><br><span class="line">                  message: &#x27;恭喜你，操作成功&#x27;,</span><br><span class="line">                  type: &#x27;success&#x27;,</span><br><span class="line">                  onClose: () =&gt; &#123;</span><br><span class="line">                     this.resetForm(formName)</span><br><span class="line">                  &#125;</span><br><span class="line">               &#125;);</span><br><span class="line">               this.permDialogFormVisible = false</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      created() &#123;</span><br><span class="line">         this.getRoleList()</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h2 id="14-用户界面"><a href="#14-用户界面" class="headerlink" title="14. 用户界面"></a>14. 用户界面</h2><p><img src="https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/20210423/0ee3a701e0584acba0aebed3936be4ad.png" alt="图片"></p>
<p>线上演示：<a target="_blank" rel="noopener" href="https://www.markerhub.com/vueadmin/">https://www.markerhub.com/vueadmin/</a></p>
<p>用户管理有个操作叫分配角色，和角色添加权限差不多的操作</p>
<p>贴代码啦：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;div&gt;</span><br><span class="line">      &lt;!--搜索框--&gt;</span><br><span class="line">      &lt;el-form :inline=&quot;true&quot; :model=&quot;searchForm&quot;&gt;</span><br><span class="line">         &lt;el-form-item&gt;</span><br><span class="line">            &lt;el-input</span><br><span class="line">                  v-model=&quot;searchForm.username&quot;</span><br><span class="line">                  placeholder=&quot;名称&quot;</span><br><span class="line">                  clearable&gt;</span><br><span class="line">            &lt;/el-input&gt;</span><br><span class="line">         &lt;/el-form-item&gt;</span><br><span class="line">         &lt;el-form-item&gt;</span><br><span class="line">            &lt;el-button&gt;搜索&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button type=&quot;primary&quot; @click=&quot;dialogFormVisible = true&quot; v-if=&quot;hasAuth(&#x27;sys:user:save&#x27;)&quot;&gt;新增&lt;/el-button&gt;</span><br><span class="line">            &lt;el-popconfirm title=&quot;确定要删除这些记录吗？&quot; @confirm=&quot;delHandle(null)&quot; style=&quot;margin-left: 10px;&quot; v-if=&quot;hasAuth(&#x27;sys:user:delete&#x27;)&quot;&gt;</span><br><span class="line">               &lt;el-button type=&quot;danger&quot; slot=&quot;reference&quot; :disabled=&quot;delBtnStu&quot;&gt;批量删除&lt;/el-button&gt;</span><br><span class="line">            &lt;/el-popconfirm&gt;</span><br><span class="line">         &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">      &lt;!--列表--&gt;</span><br><span class="line">      &lt;el-table</span><br><span class="line">            ref=&quot;multipleTable&quot;</span><br><span class="line">            border</span><br><span class="line">            stripe</span><br><span class="line">            :data=&quot;tableData&quot;</span><br><span class="line">            tooltip-effect=&quot;dark&quot;</span><br><span class="line">            style=&quot;width: 100%&quot;</span><br><span class="line">            @selection-change=&quot;handleSelectionChange&quot;&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               type=&quot;selection&quot;</span><br><span class="line">               width=&quot;55&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               label=&quot;头像&quot;</span><br><span class="line">               width=&quot;50&quot;&gt;</span><br><span class="line">            &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">               &lt;el-avatar size=&quot;small&quot;</span><br><span class="line">                          :src=&quot;scope.row.avatar&quot;&gt;&lt;/el-avatar&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;username&quot;</span><br><span class="line">               label=&quot;用户名&quot;</span><br><span class="line">               width=&quot;120&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               label=&quot;角色名称&quot;</span><br><span class="line">               width=&quot;180&quot;&gt;</span><br><span class="line">            &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">               &lt;el-tag style=&quot;margin-right: 5px;&quot; size=&quot;small&quot; type=&quot;info&quot; v-for=&quot;item in scope.row.roles&quot;&gt;&#123;&#123;item.name&#125;&#125;&lt;/el-tag&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;email&quot;</span><br><span class="line">               label=&quot;邮箱&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;phone&quot;</span><br><span class="line">               label=&quot;手机号&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               label=&quot;状态&quot;&gt;</span><br><span class="line">            &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">               &lt;el-tag v-if=&quot;scope.row.statu === 0&quot; size=&quot;small&quot; type=&quot;danger&quot;&gt;禁用&lt;/el-tag&gt;</span><br><span class="line">               &lt;el-tag v-else-if=&quot;scope.row.statu === 1&quot; size=&quot;small&quot; type=&quot;success&quot;&gt;正常&lt;/el-tag&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               prop=&quot;created&quot;</span><br><span class="line">               label=&quot;创建时间&quot;</span><br><span class="line">               width=&quot;200&quot;&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">         &lt;el-table-column</span><br><span class="line">               width=&quot;260px&quot;</span><br><span class="line">               label=&quot;操作&quot;&gt;</span><br><span class="line">            &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">               &lt;el-button type=&quot;text&quot; @click=&quot;roleHandle(scope.row.id)&quot; v-if=&quot;hasAuth(&#x27;sys:user:role&#x27;)&quot;&gt;分配角色&lt;/el-button&gt;</span><br><span class="line">               &lt;el-divider direction=&quot;vertical&quot;&gt;&lt;/el-divider&gt;</span><br><span class="line">               &lt;el-button type=&quot;text&quot; @click=&quot;repassHandle(scope.row.id, scope.row.username)&quot; v-if=&quot;hasAuth(&#x27;sys:user:repass&#x27;)&quot;&gt;重置密码&lt;/el-button&gt;</span><br><span class="line">               &lt;el-divider direction=&quot;vertical&quot;&gt;&lt;/el-divider&gt;</span><br><span class="line">               &lt;el-button type=&quot;text&quot; @click=&quot;editHandle(scope.row.id)&quot; v-if=&quot;hasAuth(&#x27;sys:user:update&#x27;)&quot;&gt;编辑&lt;/el-button&gt;</span><br><span class="line">               &lt;el-divider direction=&quot;vertical&quot;&gt;&lt;/el-divider&gt;</span><br><span class="line">               &lt;el-popconfirm title=&quot;确定要删除这条记录吗？&quot; @confirm=&quot;delHandle(scope.row.id)&quot; v-if=&quot;hasAuth(&#x27;sys:user:delete&#x27;)&quot;&gt;</span><br><span class="line">                  &lt;el-button type=&quot;text&quot; slot=&quot;reference&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">               &lt;/el-popconfirm&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">         &lt;/el-table-column&gt;</span><br><span class="line">      &lt;/el-table&gt;</span><br><span class="line">      &lt;!--页码--&gt;</span><br><span class="line">      &lt;el-pagination</span><br><span class="line">            @size-change=&quot;handleSizeChange&quot;</span><br><span class="line">            @current-change=&quot;handleCurrentChange&quot;</span><br><span class="line">            :current-page=&quot;current&quot;</span><br><span class="line">            :page-sizes=&quot;[10, 20, 50, 100]&quot;</span><br><span class="line">            :page-size=&quot;size&quot;</span><br><span class="line">            layout=&quot;total, sizes, prev, pager, next, jumper&quot;</span><br><span class="line">            :total=&quot;total&quot;&gt;</span><br><span class="line">      &lt;/el-pagination&gt;</span><br><span class="line">      &lt;el-dialog title=&quot;用户信息&quot; :visible.sync=&quot;dialogFormVisible&quot; width=&quot;600px&quot;&gt;</span><br><span class="line">         &lt;el-form :model=&quot;editForm&quot; :rules=&quot;editFormRules&quot; ref=&quot;editForm&quot;&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;用户名&quot; prop=&quot;username&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;editForm.username&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">               &lt;el-alert</span><br><span class="line">                     title=&quot;初始密码为888888&quot;</span><br><span class="line">                     :closable=&quot;false&quot;</span><br><span class="line">                     type=&quot;info&quot;</span><br><span class="line">                     style=&quot;line-height: 12px;&quot;</span><br><span class="line">               &gt;&lt;/el-alert&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;邮箱&quot;  prop=&quot;email&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;editForm.email&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;手机号&quot;  prop=&quot;phone&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;editForm.phone&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;状态&quot;  prop=&quot;statu&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">               &lt;el-radio-group v-model=&quot;editForm.statu&quot;&gt;</span><br><span class="line">                  &lt;el-radio :label=&quot;0&quot;&gt;禁用&lt;/el-radio&gt;</span><br><span class="line">                  &lt;el-radio :label=&quot;1&quot;&gt;正常&lt;/el-radio&gt;</span><br><span class="line">               &lt;/el-radio-group&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">         &lt;/el-form&gt;</span><br><span class="line">         &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">            &lt;el-button @click=&quot;resetForm(&#x27;editForm&#x27;)&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button type=&quot;primary&quot; @click=&quot;submitEditForm(&#x27;editForm&#x27;)&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">         &lt;/div&gt;</span><br><span class="line">      &lt;/el-dialog&gt;</span><br><span class="line">      &lt;!-- 分配权限对话框 --&gt;</span><br><span class="line">      &lt;el-dialog title=&quot;分配角色&quot; :visible.sync=&quot;roleDialogFormVisible&quot; width=&quot;600px&quot; @closed=&quot;resetForm(&#x27;roleForm&#x27;)&quot;&gt;</span><br><span class="line">         &lt;el-form :model=&quot;roleForm&quot; ref=&quot;roleForm&quot;&gt;</span><br><span class="line">            &lt;el-tree</span><br><span class="line">                  :data=&quot;roleTreeData&quot;</span><br><span class="line">                  show-checkbox</span><br><span class="line">                  ref=&quot;roleTree&quot;</span><br><span class="line">                  node-key=&quot;id&quot;</span><br><span class="line">                  :default-expand-all=true</span><br><span class="line">                  :props=&quot;defaultProps&quot;&gt;</span><br><span class="line">            &lt;/el-tree&gt;</span><br><span class="line">         &lt;/el-form&gt;</span><br><span class="line">         &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">            &lt;el-button @click=&quot;resetForm(&#x27;roleForm&#x27;)&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button type=&quot;primary&quot; @click=&quot;submitRoleForm(&#x27;roleForm&#x27;)&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">         &lt;/div&gt;</span><br><span class="line">      &lt;/el-dialog&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">   export default &#123;</span><br><span class="line">      name: &quot;User&quot;,</span><br><span class="line">      data() &#123;</span><br><span class="line">         return &#123;</span><br><span class="line">            searchForm: &#123;</span><br><span class="line">               username: &#x27;&#x27;</span><br><span class="line">            &#125;,</span><br><span class="line">            editForm: &#123;</span><br><span class="line">            &#125;,</span><br><span class="line">            editFormRules: &#123;</span><br><span class="line">               username: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请输入用户名称&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ],</span><br><span class="line">               email: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请输入邮箱&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ],</span><br><span class="line">               statu: [</span><br><span class="line">                  &#123;required: true, message: &#x27;请选择状态&#x27;, trigger: &#x27;blur&#x27;&#125;</span><br><span class="line">               ]</span><br><span class="line">            &#125;,</span><br><span class="line">            current: 1,</span><br><span class="line">            total: 0,</span><br><span class="line">            size: 10,</span><br><span class="line">            dialogFormVisible: false,</span><br><span class="line">            tableData: [],</span><br><span class="line">            multipleSelection: [],</span><br><span class="line">            delBtnStu: true,</span><br><span class="line">            roleDialogFormVisible: false,</span><br><span class="line">            roleForm: &#123;</span><br><span class="line">            &#125;,</span><br><span class="line">            defaultProps: &#123;</span><br><span class="line">               children: &#x27;children&#x27;,</span><br><span class="line">               label: &#x27;name&#x27;</span><br><span class="line">            &#125;,</span><br><span class="line">            roleTreeData:  [],</span><br><span class="line">            treeCheckedKeys: [],</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">         toggleSelection(rows) &#123;</span><br><span class="line">            if (rows) &#123;</span><br><span class="line">               rows.forEach(row =&gt; &#123;</span><br><span class="line">                  this.$refs.multipleTable.toggleRowSelection(row);</span><br><span class="line">               &#125;);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">               this.$refs.multipleTable.clearSelection();</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;,</span><br><span class="line">         handleSelectionChange(rows) &#123;</span><br><span class="line">            this.multipleSelection = rows;</span><br><span class="line">            this.delBtnStu = rows.length == 0</span><br><span class="line">         &#125;,</span><br><span class="line">         getUserList() &#123;</span><br><span class="line">            this.$axios.get(&#x27;/sys/user/list&#x27;, &#123;</span><br><span class="line">               params: &#123;</span><br><span class="line">                  name: this.searchForm.name,</span><br><span class="line">                  current: this.current,</span><br><span class="line">                  size: this.size</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;).then(res =&gt; &#123;</span><br><span class="line">               this.tableData = res.data.data.records</span><br><span class="line">               this.current = res.data.data.current</span><br><span class="line">               this.size = res.data.data.size</span><br><span class="line">               this.total = res.data.data.total</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">         handleSizeChange(val) &#123;</span><br><span class="line">            this.size = val</span><br><span class="line">            this.getUserList()</span><br><span class="line">         &#125;,</span><br><span class="line">         handleCurrentChange(val) &#123;</span><br><span class="line">            this.current = val</span><br><span class="line">            this.getUserList()</span><br><span class="line">         &#125;,</span><br><span class="line">         submitEditForm(formName) &#123;</span><br><span class="line">            this.$refs[formName].validate((valid) =&gt; &#123;</span><br><span class="line">               if (valid) &#123;</span><br><span class="line">                  this.$axios.post(&#x27;/sys/user/&#x27; + (this.editForm.id? &quot;update&quot; : &quot;save&quot;) ,this.editForm)</span><br><span class="line">                     .then(res =&gt; &#123;</span><br><span class="line">                        console.log(res.data)</span><br><span class="line">                        this.resetForm(formName)</span><br><span class="line">                        this.$message(&#123;</span><br><span class="line">                           showClose: true,</span><br><span class="line">                           message: &#x27;恭喜你，操作成功&#x27;,</span><br><span class="line">                           type: &#x27;success&#x27;,</span><br><span class="line">                           onClose: () =&gt; &#123;</span><br><span class="line">                              this.getUserList()</span><br><span class="line">                           &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">                     &#125;)</span><br><span class="line">               &#125; else &#123;</span><br><span class="line">                  console.log(&#x27;error submit!!&#x27;);</span><br><span class="line">                  return false;</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">         &#125;,</span><br><span class="line">         editHandle(id) &#123;</span><br><span class="line">            console.log(id)</span><br><span class="line">            this.$axios.get(&quot;/sys/user/info/&quot; + id).then(res =&gt; &#123;</span><br><span class="line">               this.editForm = res.data.data</span><br><span class="line">               this.dialogFormVisible = true</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">         delHandle(id) &#123;</span><br><span class="line">            var ids = []</span><br><span class="line">            id ? ids.push(id) : this.multipleSelection.forEach(row =&gt; &#123;</span><br><span class="line">               ids.push(row.id)</span><br><span class="line">            &#125;)</span><br><span class="line">            console.log(ids)</span><br><span class="line">            this.$axios.post(&quot;/sys/user/delete&quot;, ids).then(res =&gt; &#123;</span><br><span class="line">               this.$message(&#123;</span><br><span class="line">                  showClose: true,</span><br><span class="line">                  message: &#x27;恭喜你，操作成功&#x27;,</span><br><span class="line">                  type: &#x27;success&#x27;,</span><br><span class="line">                  onClose: () =&gt; &#123;</span><br><span class="line">                     this.getUserList()</span><br><span class="line">                  &#125;</span><br><span class="line">               &#125;);</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">         resetForm(formName) &#123;</span><br><span class="line">            this.$refs[formName].resetFields();</span><br><span class="line">            this.editForm = &#123;&#125;</span><br><span class="line">            this.dialogFormVisible = false</span><br><span class="line">            this.roleDialogFormVisible = false</span><br><span class="line">         &#125;,</span><br><span class="line">         roleHandle(id) &#123;</span><br><span class="line">            this.$axios.get(&quot;/sys/user/info/&quot; + id).then(res =&gt; &#123;</span><br><span class="line">               const sysuser = res.data.data</span><br><span class="line">               var roleIds = []</span><br><span class="line">               sysuser.roles.forEach(row =&gt; &#123;</span><br><span class="line">                  roleIds.push(row.id)</span><br><span class="line">               &#125;)</span><br><span class="line">               console.log(&quot;roleIds&quot;)</span><br><span class="line">               console.log(roleIds)</span><br><span class="line">               this.roleForm = res.data.data</span><br><span class="line">               console.log(&quot;this.treeCheckedKeys&quot;)</span><br><span class="line">               console.log(this.treeCheckedKeys)</span><br><span class="line">               this.$axios.get(&quot;/sys/role/list&quot;).then(res =&gt; &#123;</span><br><span class="line">                  this.roleTreeData = res.data.data.records</span><br><span class="line">                  this.$refs.roleTree.setCheckedKeys(roleIds);</span><br><span class="line">               &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">            this.roleDialogFormVisible = true</span><br><span class="line">         &#125;,</span><br><span class="line">         submitRoleForm(formName) &#123;</span><br><span class="line">            var roleIds = []</span><br><span class="line">            roleIds = this.$refs.roleTree.getCheckedKeys()</span><br><span class="line">            console.log(roleIds)</span><br><span class="line">            console.log(this.roleForm.id)</span><br><span class="line">            this.$axios.post(&quot;/sys/user/role/&quot; + this.roleForm.id, roleIds).then(res =&gt; &#123;</span><br><span class="line">               this.$message(&#123;</span><br><span class="line">                  showClose: true,</span><br><span class="line">                  message: &#x27;恭喜你，操作成功&#x27;,</span><br><span class="line">                  type: &#x27;success&#x27;,</span><br><span class="line">                  onClose: () =&gt; &#123;</span><br><span class="line">                     this.resetForm(formName)</span><br><span class="line">                     this.getUserList()</span><br><span class="line">                  &#125;</span><br><span class="line">               &#125;);</span><br><span class="line">               this.roleDialogFormVisible = false</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;,</span><br><span class="line">         repassHandle(id, username) &#123;</span><br><span class="line">            this.$confirm(&#x27;将重置用户【&#x27; + username + &#x27;】的密码, 是否继续?&#x27;, &#x27;提示&#x27;, &#123;</span><br><span class="line">               confirmButtonText: &#x27;确定&#x27;,</span><br><span class="line">               cancelButtonText: &#x27;取消&#x27;,</span><br><span class="line">               type: &#x27;warning&#x27;</span><br><span class="line">            &#125;).then(() =&gt; &#123;</span><br><span class="line">               this.$axios.post(&quot;/sys/user/repass&quot;, id).then(res =&gt; &#123;</span><br><span class="line">                  this.$message(&#123;</span><br><span class="line">                     showClose: true,</span><br><span class="line">                     message: &#x27;恭喜你，操作成功&#x27;,</span><br><span class="line">                     type: &#x27;success&#x27;,</span><br><span class="line">                     onClose: () =&gt; &#123;</span><br><span class="line">                     &#125;</span><br><span class="line">                  &#125;);</span><br><span class="line">               &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      created() &#123;</span><br><span class="line">         this.getUserList()</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h2 id="15-按钮权限的控制"><a href="#15-按钮权限的控制" class="headerlink" title="15. 按钮权限的控制"></a>15. 按钮权限的控制</h2><p>上面的菜单、角色、用户有增删改查操作，但是不是每个用户都有权限的，没权限的用户我们应该隐藏按钮，因此我们需要通过条件来判断按钮是否应该显示，那么应该怎么定义一个方法可以让全局都能使用呢？</p>
<p>我们再src下面新建一个js文件用于定义一个全局使用的方法：</p>
<ul>
<li>src/globalFun.js</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &#x27;vue&#x27;</span><br><span class="line">Vue.mixin(&#123;</span><br><span class="line">   methods: &#123;</span><br><span class="line">      hasAuth(perm) &#123;</span><br><span class="line">         var authority = this.$store.state.menus.permList</span><br><span class="line">         console.log(authority)</span><br><span class="line">         return authority.indexOf(perm) &gt; -1</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>之前我们在加载菜单的时候说过，我们同时要加载权限数据，现在就需要用到权限数据了，这里数组，因此我们通过按钮的权限是否在所有权限列表内就行了。<br>mixin的作用是多个组件可以共享数据和方法，在使用mixin的组件中引入后，mixin中的方法和属性也就并入到该组件中，可以直接使用，在已有的组件数据和方法进行了扩充。引入mixin分全局引用和局部引用。</p>
<p>然后我们需要在main.js中引入这个文件</p>
<ul>
<li>src\main.js</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import gobal from &quot;./globalFun&quot;</span><br></pre></td></tr></table></figure>

<p>这样全局就可以使用啦，比如我们在新增按钮这里做判断：</p>
<ul>
<li>src/views/sys/Menu.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-button type=&quot;primary&quot; @click=&quot;dialogFormVisible = true&quot; v-if=&quot;hasAuth(&#x27;sys:menu:save&#x27;)&quot;&gt;新增&lt;/el-button&gt;</span><br></pre></td></tr></table></figure>

<p>通过v-if来判断返回是否为true从而判断是否显示。</p>
<h2 id="16-结束语"><a href="#16-结束语" class="headerlink" title="16. 结束语"></a>16. 结束语</h2><p>视频讲解：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1af4y1s7Wh/">https://www.bilibili.com/video/BV1af4y1s7Wh/</a></p>
<p>线上演示：<a target="_blank" rel="noopener" href="https://www.markerhub.com/vueadmin/">https://www.markerhub.com/vueadmin/</a></p>
<p>首发公众号：MarkerHub</p>
<p>撰写人：吕一明</p>
<p>转载请保留此声明，感谢！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-VUE_router守卫" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2022/04/08/VUE_router%E5%AE%88%E5%8D%AB/" class="article-date">
      <time datetime="2022-04-08T12:54:23.030Z" itemprop="datePublished">2022-04-08</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/04/08/VUE_router%E5%AE%88%E5%8D%AB/">VUE_router守卫</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="全局守卫"><a href="#全局守卫" class="headerlink" title="全局守卫"></a>全局守卫</h3><h5 id="1、请求一个路径：如：-Index"><a href="#1、请求一个路径：如：-Index" class="headerlink" title="1、请求一个路径：如：/Index"></a>1、请求一个路径：如：/Index</h5><h5 id="2、经历前置守卫（路由配置前）"><a href="#2、经历前置守卫（路由配置前）" class="headerlink" title="2、经历前置守卫（路由配置前）"></a>2、经历前置守卫（路由配置前）</h5><h5 id="决定了能去哪个路径"><a href="#决定了能去哪个路径" class="headerlink" title="决定了能去哪个路径"></a>决定了能去哪个路径</h5><h5 id="3、根据去的路径，找对应component（路由配置）"><a href="#3、根据去的路径，找对应component（路由配置）" class="headerlink" title="3、根据去的路径，找对应component（路由配置）"></a>3、根据去的路径，找对应component（路由配置）</h5><h5 id="4、经过后置守卫（路由配置后）"><a href="#4、经过后置守卫（路由配置后）" class="headerlink" title="4、经过后置守卫（路由配置后）"></a>4、经过后置守卫（路由配置后）</h5><h5 id="5、创建组件"><a href="#5、创建组件" class="headerlink" title="5、创建组件"></a>5、创建组件</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>前置钩子</span><br><span class="line"></span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123; </span><br><span class="line"> 	 <span class="comment">//	to: 目标路由</span></span><br><span class="line"> 	 <span class="comment">//	from: 当前路由  </span></span><br><span class="line"> 	 <span class="comment">// next() 跳转  一定要调用</span></span><br><span class="line">  next(<span class="literal">false</span>);<span class="comment">//不让走</span></span><br><span class="line">  next(<span class="literal">true</span>);<span class="comment">//继续前行</span></span><br><span class="line">  next(<span class="string">&#x27;/login&#x27;</span>)<span class="comment">//走哪</span></span><br><span class="line">  next(&#123;<span class="attr">path</span>:<span class="string">&#x27;/detail/2&#x27;</span>,<span class="attr">params</span>:&#123;&#125;,<span class="attr">query</span>:&#123;&#125;&#125;)<span class="comment">//带点货</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 守卫业务</span></span><br><span class="line">  <span class="keyword">if</span>(to.path==<span class="string">&#x27;/login&#x27;</span> || to.path==<span class="string">&#x27;/reg&#x27;</span> )&#123;    </span><br><span class="line">    next(<span class="literal">true</span>)</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="comment">//是否登录的判断</span></span><br><span class="line">      <span class="keyword">if</span>(没有登录过)&#123;</span><br><span class="line">          next(<span class="string">&#x27;/login&#x27;</span>);</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          next(<span class="literal">true</span>);</span><br><span class="line">       &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>后置</span><br><span class="line">router.afterEach(<span class="function">(<span class="params">to,<span class="keyword">from</span></span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="comment">//全局后置守卫业务</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//过程：</span></span><br></pre></td></tr></table></figure>



<h3 id="路由独享守卫"><a href="#路由独享守卫" class="headerlink" title="路由独享守卫"></a>路由独享守卫</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/index.js</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">path</span>: <span class="string">&#x27;/user&#x27;</span>,</span><br><span class="line">  <span class="attr">component</span>: User,</span><br><span class="line">  <span class="comment">//路由独享守卫</span></span><br><span class="line">  <span class="attr">beforeEnter</span>: <span class="function">(<span class="params">to,<span class="keyword">from</span>,next</span>)=&gt;</span>&#123; <span class="comment">//路由独享守卫 前置 </span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;路由独享守卫&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">Math</span>.random()&lt;<span class="number">.5</span>)&#123;</span><br><span class="line">      next()</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      next(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h3 id="组件内部守卫"><a href="#组件内部守卫" class="headerlink" title="组件内部守卫"></a>组件内部守卫</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在组件内部写：</span></span><br><span class="line"><span class="comment">//组件内部钩子</span></span><br><span class="line">beforeRouteEnter (to, <span class="keyword">from</span>, next) &#123;<span class="comment">//前置</span></span><br><span class="line">  <span class="comment">// 不！能！获取组件实例 `this`</span></span><br><span class="line">  <span class="comment">// 因为当守卫执行前，组件实例还没被创建</span></span><br><span class="line">&#125;,</span><br><span class="line">beforeRouteUpdate (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">  <span class="comment">// 在当前路由改变，但是该组件被复用时调用</span></span><br><span class="line">  <span class="comment">// 举例来说，对于一个带有动态参数的路径 /foo/:id，在 /foo/1 和 /foo/2 之间跳转的时候，</span></span><br><span class="line">  <span class="comment">// 由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。</span></span><br><span class="line">  <span class="comment">// 可以访问组件实例 `this`</span></span><br><span class="line">&#125;,</span><br><span class="line">beforeRouteLeave (to, <span class="keyword">from</span>, next) &#123;<span class="comment">//后置</span></span><br><span class="line">  <span class="comment">// 导航离开该组件的对应路由时调用</span></span><br><span class="line">  <span class="comment">// 可以访问组件实例 `this`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-VUE_权限开发" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2022/04/08/VUE_%E6%9D%83%E9%99%90%E5%BC%80%E5%8F%91/" class="article-date">
      <time datetime="2022-04-08T12:23:59.878Z" itemprop="datePublished">2022-04-08</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/04/08/VUE_%E6%9D%83%E9%99%90%E5%BC%80%E5%8F%91/">VUE_权限</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>1：有多少导航就绑定多少路由：动态绑定路由</p>
<p>2：加载菜单栏的时候加载权限的信息，就是在下一次发起路由的请求的时候进行一个拦截，看有没有这个权限，没有权限的时候就跳到登录</p>
<p>更偏向于第一个</p>
<p>问题：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取导航栏信息的时候不能在data里面写menuList:this.$store.state.menus.menusList</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//因为在SideMenu组件渲染是在router.beforeEach之前的，渲染的时候还没有请求到导航栏数据，所以利用computed计算属性里面的get()去动态获取menuList</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">//menuList:this.$store.state.menus.menuList</span></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220409115245088.png" alt="image-20220409115245088"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-CSS_圣杯布局和双飞翼布局" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2022/04/08/CSS_%E5%9C%A3%E6%9D%AF%E5%B8%83%E5%B1%80%E5%92%8C%E5%8F%8C%E9%A3%9E%E7%BF%BC%E5%B8%83%E5%B1%80/" class="article-date">
      <time datetime="2022-04-08T07:56:25.394Z" itemprop="datePublished">2022-04-08</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/04/08/CSS_%E5%9C%A3%E6%9D%AF%E5%B8%83%E5%B1%80%E5%92%8C%E5%8F%8C%E9%A3%9E%E7%BF%BC%E5%B8%83%E5%B1%80/">CSS_圣杯布局和双飞翼布局</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="圣杯布局"><a href="#圣杯布局" class="headerlink" title="圣杯布局"></a>圣杯布局</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span>&gt;</span>main<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span>left<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span>right<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a>第一步</h4><p>首先设置好<code>.main</code>、<code>.left</code>、<code>.right</code>的宽度并浮动，为左右两列预留出空间。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">200px</span>;  <span class="comment">/* 预留左侧空间，为.left宽度*/</span></span><br><span class="line">  <span class="attribute">padding-right</span>: <span class="number">300px</span>; <span class="comment">/* 预留右侧空间，为.right宽度*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#67c23a</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#e6a23c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f56c6c</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/9067067-83e70418849c3c1f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>图片</p>
<h4 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a>第二步</h4><p>通过<code>负margin</code>、<code>position</code>把<code>left</code>移动到左侧预留位置。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">100%</span>;   <span class="comment">/* 移动到左侧，100%是一个父元素宽度，这里也就是.container的宽度 */</span></span><br><span class="line">  <span class="attribute">position</span>: relative;   <span class="comment">/* 因为.container设置了padding */</span></span><br><span class="line">  <span class="attribute">right</span>: <span class="number">200px</span>;         <span class="comment">/* 所以需要再向左移动自身宽度,left: -200px;也是可以的 */</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#e6a23c</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/9067067-2e7a45e65face7e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>图片</p>
<h4 id="第三步"><a href="#第三步" class="headerlink" title="第三步"></a>第三步</h4><p>通过<code>负margin</code>把<code>right</code>移动到右侧预留位置。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">margin-right</span>: -<span class="number">300px</span>; <span class="comment">/* 移动到右侧，自身宽度*/</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f56c6c</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/9067067-0db700966e8ee999.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>图片</p>
<p>完整代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">200px</span>;  <span class="comment">/* 预留左侧空间，为.left宽度*/</span></span><br><span class="line">  <span class="attribute">padding-right</span>: <span class="number">300px</span>; <span class="comment">/* 预留左侧空间，为.right宽度*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#67c23a</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">100%</span>;   <span class="comment">/* 移动到左侧，100%是一个父元素宽度，这里也就是.container的宽度 */</span></span><br><span class="line">  <span class="attribute">position</span>: relative;   <span class="comment">/* 因为.container设置了padding*/</span></span><br><span class="line">  <span class="attribute">right</span>: <span class="number">200px</span>;         <span class="comment">/* 所以需要再向左移动自身宽度,left: -200px;也是可以的 */</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#e6a23c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">margin-right</span>: -<span class="number">300px</span>; <span class="comment">/* 移动到右侧，自身宽度*/</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f56c6c</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="双飞翼布局"><a href="#双飞翼布局" class="headerlink" title="双飞翼布局"></a>双飞翼布局</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main-wrap&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span>&gt;</span>main<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span>left<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span>right<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="第一步-1"><a href="#第一步-1" class="headerlink" title="第一步"></a>第一步</h4><p>首先设置好<code>.wrap</code>、<code>.main-wrap</code>、<code>.left</code>、<code>.right</code>的宽度并浮动，为左右两列预留出空间。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.main-wrap</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;  <span class="comment">/* 这个必须设置，不然浮动起来，没宽度 */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">200px</span>;   <span class="comment">/* 预留左侧空间，为.left宽度 */</span></span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">300px</span>;  <span class="comment">/* 预留左侧空间，为.right宽度 */</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#67c23a</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#e6a23c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f56c6c</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/9067067-8514f39031167f53.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>图片</p>
<h4 id="第二步-1"><a href="#第二步-1" class="headerlink" title="第二步"></a>第二步</h4><p>通过<code>负margin</code>把<code>left</code>移动到左侧预留位置。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">100%</span>;   <span class="comment">/* 移动到左侧，100%是一个父元素宽度，这里也就是body的宽度*/</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#e6a23c</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/9067067-cfd602ba61e12292.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>图片</p>
<h4 id="第三步-1"><a href="#第三步-1" class="headerlink" title="第三步"></a>第三步</h4><p>通过<code>负margin</code>把<code>right</code>移动到右侧预留位置。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">300px</span>;  <span class="comment">/* 移动到右侧，自身宽度*/</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f56c6c</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/9067067-9fa427c92f1c7e77.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>图片</p>
<p>完整代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.main-wrap</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">200px</span>;   <span class="comment">/* 预留左侧空间，为.left宽度*/</span></span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">300px</span>;  <span class="comment">/* 预留左侧空间，为.right宽度*/</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#67c23a</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">100%</span>;   <span class="comment">/* 移动到左侧，100%是一个父元素宽度，这里也就是body的宽度*/</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#e6a23c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">300px</span>;  <span class="comment">/* 移动到右侧，自身宽度*/</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f56c6c</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-VUE_Vuex" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2022/04/08/VUE_Vuex/" class="article-date">
      <time datetime="2022-04-08T06:24:00.230Z" itemprop="datePublished">2022-04-08</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/04/08/VUE_Vuex/">Vue_Vuex</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="Vuex有五个核心概念："><a href="#Vuex有五个核心概念：" class="headerlink" title="Vuex有五个核心概念："></a>Vuex有五个核心概念：</h3><h4 id="state-getters-mutations-actions-modules。"><a href="#state-getters-mutations-actions-modules。" class="headerlink" title="state, getters, mutations, actions, modules。"></a>state, getters, mutations, actions, modules。</h4><ol>
<li><h4 id="state：vuex的基本数据，用来存储变量"><a href="#state：vuex的基本数据，用来存储变量" class="headerlink" title="state：vuex的基本数据，用来存储变量"></a>state：vuex的基本数据，用来存储变量</h4></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">state: &#123;</span><br><span class="line">   userId: &#x27;&#x27;,</span><br><span class="line">   name: &#x27;&#x27;,</span><br><span class="line">   token: &#x27;&#x27;,</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>在vue中使用 this.$store.state.userId</p>
<p>　　 2. #### geeter：从基本数据(state)派生的数据，相当于state的计算属性,具有返回值的方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">getter: &#123;</span><br><span class="line">    userIdDouble: function(state)&#123;</span><br><span class="line">      return state.userId * 2</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>


<p>在vue中使用 this.$store.getters.userIdDouble</p>
<p>在vue中使用 this.$store.getters.userIdDouble</p>
<p>　　 3. #### mutation：提交更新数据的方法，必须是同步的(如果需要异步使用action)。每个 mutation 都有一个字符串的 事件类型 (type) 和 一个 回调函数 (handler)。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mutations: &#123;</span><br><span class="line">  SET_USER: (state, userId) =&gt; &#123;</span><br><span class="line">    state.userId = userId</span><br><span class="line">  &#125;,</span><br><span class="line">  SET_TOKEN: (state, token) =&gt; &#123;</span><br><span class="line">    // console.log(token)</span><br><span class="line">    state.token = token</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>


<p>commit：同步操作，写法： this.$store.commit(‘mutations方法名’,值)<br>　列如</p>
<pre><code>this.$store.commit(&#39;SET_USER&#39;,&#39;123456&#39;)
</code></pre>
<p>回调函数就是我们实际进行状态更改的地方，并且它会接受 state 作为第一个参数，提交载荷作为第二个参数。</p>
<ol start="4">
<li><h4 id="action：和mutation的功能大致相同，不同之处在于-》1-Action-提交的是-mutation，而不是直接变更状态。-2-Action-可以包含任意异步操作。"><a href="#action：和mutation的功能大致相同，不同之处在于-》1-Action-提交的是-mutation，而不是直接变更状态。-2-Action-可以包含任意异步操作。" class="headerlink" title="action：和mutation的功能大致相同，不同之处在于 ==》1. Action 提交的是 mutation，而不是直接变更状态。 2. Action 可以包含任意异步操作。"></a>action：和mutation的功能大致相同，不同之处在于 ==》1. Action 提交的是 mutation，而不是直接变更状态。 2. Action 可以包含任意异步操作。</h4></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">actions: &#123; // &#123;&#125; 是es6中解构，把对象解构成属性</span><br><span class="line">  login(&#123; commit &#125;, value) &#123;</span><br><span class="line">    commit(&#x27;SET_USER&#x27;, value)</span><br><span class="line">    // commit(&#x27;SET_TOKEN&#x27;, value2)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>


<p>dispatch：异步操作，写法： this.$store.dispatch(‘mutations方法名’,值)</p>
<p>　　 5. #### modules：模块化vuex，可以让每一个模块拥有自己的state、mutation、action、getters,使得结构非常清晰，方便管理。<br>　　<br>　　 简单来说就是可以把以上的 state、mutation、action、getters 整合成一个user.js,然后放到store.js里面</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-VUE_$router和$route" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2022/03/30/VUE_$router%E5%92%8C$route/" class="article-date">
      <time datetime="2022-03-30T13:09:16.136Z" itemprop="datePublished">2022-03-30</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/03/30/VUE_$router%E5%92%8C$route/">VUE_$router和$route</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>一.r o u t e r 和 router和router和route的区别<br><strong>$router:是路由操作对象，包含路由跳转的方法，钩子函数等(只写对象)</strong><br> 例如：history对象 this.$router.push会往history中添加一个新的记录<br> 跳转用的链接就可以使用this.$router.push ,与router-link 跳转一样</p>
<p><strong>$route 相当于当前正在跳转的路由对象，可以获取里面的name,path,params,query等(只读对象)</strong></p>
<p>例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//$router操作 路由跳转</span><br><span class="line">this.$router.push(&#123;name:&quot;hello&quot;,params:&#123;name:&#x27;你好&#x27;，age:&#x27;18&#x27;&#125;&#125;)</span><br><span class="line"></span><br><span class="line">//$route 读取 路由参数接收</span><br><span class="line">let name = this.$route.params.name</span><br></pre></td></tr></table></figure>

<p>二、路由跳转方式（name、path）与路由传参方式（params、query）<br>path 和 name路由跳转方式，都可以使用query传参</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">//Router.js</span><br><span class="line">&#123;</span><br><span class="line">    path:&#x27;/hello&#x27;,</span><br><span class="line">    name:&#x27;HelloWorld&#x27;,</span><br><span class="line">    component:hello</span><br><span class="line">&#125;</span><br><span class="line">//跳转方式  name</span><br><span class="line">this.$router.push(&#123;</span><br><span class="line">    name:&#x27;HelloWorld&#x27;,</span><br><span class="line">    query:&#123;</span><br><span class="line">        id:123</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">//跳转方式 path</span><br><span class="line">this.$router.push(&#123;</span><br><span class="line">    path:&#x27;/hello&#x27;,</span><br><span class="line">    query:&#123;</span><br><span class="line">        id:123</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">//获取路由参数信息方式</span><br><span class="line">&#123;&#123;let id = this.$route.query.id&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意：path路由跳转方式，params传参会被忽略，只能用name命名的方式跳转<br>params传参,push里面只能是name:’xxxx’,不能是path:’/xxxx’,因为params只能用name来引入路径，<br>如果这里写成了path,接收参数页面会是undefined<br>另外，二者还有点区别，直白的来说query相当于get请求，页面跳转的时候，可以在地址栏看到请求参数，而params相当于post请求，参数不会再地址栏中显示。<br>params传参如果路由上面不写参数，也是可以传过去的，但不会在url上面显示出你的参数，并且当你跳到别的页面或者刷新页面的时候参数会丢失</strong></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-HTTP_报文协议体" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2022/03/30/HTTP_%E6%8A%A5%E6%96%87%E5%8D%8F%E8%AE%AE%E4%BD%93/" class="article-date">
      <time datetime="2022-03-30T12:44:05.591Z" itemprop="datePublished">2022-03-30</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/03/30/HTTP_%E6%8A%A5%E6%96%87%E5%8D%8F%E8%AE%AE%E4%BD%93/">HTTP_报文体</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="HTTP请求报文"><a href="#HTTP请求报文" class="headerlink" title="HTTP请求报文"></a>HTTP请求报文</h2><p>一个HTTP请求报文由四个部分组成：请求行、请求头部、空行、请求数据。<br>1.请求行</p>
<h4 id="请求行由请求方法字段、URL字段和HTTP协议版本字段3个字段组成，它们用空格分隔。比如-GET-data-info-html-HTTP-1-1"><a href="#请求行由请求方法字段、URL字段和HTTP协议版本字段3个字段组成，它们用空格分隔。比如-GET-data-info-html-HTTP-1-1" class="headerlink" title="请求行由请求方法字段、URL字段和HTTP协议版本字段3个字段组成，它们用空格分隔。比如 GET /data/info.html HTTP/1.1"></a>请求行由请求方法字段、URL字段和HTTP协议版本字段3个字段组成，它们用空格分隔。比如 GET /data/info.html HTTP/1.1</h4><h4 id="方法字段就是HTTP使用的请求方法，比如常见的GET-POST"><a href="#方法字段就是HTTP使用的请求方法，比如常见的GET-POST" class="headerlink" title="方法字段就是HTTP使用的请求方法，比如常见的GET/POST"></a>方法字段就是HTTP使用的请求方法，比如常见的GET/POST</h4><h4 id="其中HTTP协议版本有两种：HTTP1-0-HTTP1-1-可以这样区别："><a href="#其中HTTP协议版本有两种：HTTP1-0-HTTP1-1-可以这样区别：" class="headerlink" title="其中HTTP协议版本有两种：HTTP1.0/HTTP1.1 可以这样区别："></a>其中HTTP协议版本有两种：HTTP1.0/HTTP1.1 可以这样区别：</h4><h4 id="HTTP1-0对于每个连接都只能传送一个请求和响应，请求就会关闭，HTTP1-0没有Host字段-而HTTP1-1在同一个连接中可以传送多个请求和响应，多个请求可以重叠和同时进行，HTTP1-1必须有Host字段。"><a href="#HTTP1-0对于每个连接都只能传送一个请求和响应，请求就会关闭，HTTP1-0没有Host字段-而HTTP1-1在同一个连接中可以传送多个请求和响应，多个请求可以重叠和同时进行，HTTP1-1必须有Host字段。" class="headerlink" title="HTTP1.0对于每个连接都只能传送一个请求和响应，请求就会关闭，HTTP1.0没有Host字段;而HTTP1.1在同一个连接中可以传送多个请求和响应，多个请求可以重叠和同时进行，HTTP1.1必须有Host字段。"></a>HTTP1.0对于每个连接都只能传送一个请求和响应，请求就会关闭，HTTP1.0没有Host字段;而HTTP1.1在同一个连接中可以传送多个请求和响应，多个请求可以重叠和同时进行，HTTP1.1必须有Host字段。</h4><p>2.请求头部<br>HTTP客户程序(例如浏览器)，向服务器发送请求的时候必须指明请求类型(一般是GET或者 POST)。如有必要，客户程序还可以选择发送其他的请求头。大多数请求头并不是必需的，但Content-Length除外。对于POST请求来说 Content-Length必须出现。<br>常见的请求头字段含义：<br>Accept： 浏览器可接受的MIME类型。<br>Accept-Charset：浏览器可接受的字符集。<br>Accept-Encoding：浏览器能够进行解码的数据编码方式，比如gzip。Servlet能够向支持gzip的浏览器返回经gzip编码的HTML页面。许多情形下这可以减少5到10倍的下载时间。<br>Accept-Language：浏览器所希望的语言种类，当服务器能够提供一种以上的语言版本时要用到。<br>Authorization：授权信息，通常出现在对服务器发送的WWW-Authenticate头的应答中。</p>
<h4 id="Content-Length：表示请求消息正文的长度。"><a href="#Content-Length：表示请求消息正文的长度。" class="headerlink" title="Content-Length：表示请求消息正文的长度。"></a>Content-Length：表示请求消息正文的长度。</h4><h4 id="Host：-客户机通过这个头告诉服务器，想访问的主机名。Host头域指定请求资源的Intenet主机和端口号，必须表示请求url的原始服务器或网关的位置。HTTP-1-1请求必须包含主机头域，否则系统会以400状态码返回。"><a href="#Host：-客户机通过这个头告诉服务器，想访问的主机名。Host头域指定请求资源的Intenet主机和端口号，必须表示请求url的原始服务器或网关的位置。HTTP-1-1请求必须包含主机头域，否则系统会以400状态码返回。" class="headerlink" title="Host： 客户机通过这个头告诉服务器，想访问的主机名。Host头域指定请求资源的Intenet主机和端口号，必须表示请求url的原始服务器或网关的位置。HTTP/1.1请求必须包含主机头域，否则系统会以400状态码返回。"></a>Host： 客户机通过这个头告诉服务器，想访问的主机名。Host头域指定请求资源的Intenet主机和端口号，必须表示请求url的原始服务器或网关的位置。HTTP/1.1请求必须包含主机头域，否则系统会以400状态码返回。</h4><p>If-Modified-Since：客户机通过这个头告诉服务器，资源的缓存时间。只有当所请求的内容在指定的时间后又经过修改才返回它，否则返回304“Not Modified”应答。<br>Referer：客户机通过这个头告诉服务器，它是从哪个资源来访问服务器的(防盗链)。包含一个URL，用户从该URL代表的页面出发访问当前请求的页面。<br>User-Agent：User-Agent头域的内容包含发出请求的用户信息。浏览器类型，如果Servlet返回的内容与浏览器类型有关则该值非常有用。</p>
<h4 id="Cookie：客户机通过这个头可以向服务器带数据，这是最重要的请求头信息之一。"><a href="#Cookie：客户机通过这个头可以向服务器带数据，这是最重要的请求头信息之一。" class="headerlink" title="Cookie：客户机通过这个头可以向服务器带数据，这是最重要的请求头信息之一。"></a>Cookie：客户机通过这个头可以向服务器带数据，这是最重要的请求头信息之一。</h4><p>Pragma：指定“no-cache”值表示服务器必须返回一个刷新后的文档，即使它是代理服务器而且已经有了页面的本地拷贝。<br>From：请求发送者的email地址，由一些特殊的Web客户程序使用，浏览器不会用到它。</p>
<h4 id="Connection：处理完这次请求后是否断开连接还是继续保持连接。如果Servlet看到这里的值为“Keep-Alive”，或者看到请求使用的是HTTP-1-1-HTTP-1-1默认进行持久连接-，它就可以利用持久连接的优点，当页面包含多个元素时-例如Applet，图片-，显著地减少下载所需要的时间。要实现这一点，Servlet需要在应答中发送一个Content-Length头，最简单的实现方法是：先把内容写入-ByteArrayOutputStream，然后在正式写出内容之前计算它的大小。"><a href="#Connection：处理完这次请求后是否断开连接还是继续保持连接。如果Servlet看到这里的值为“Keep-Alive”，或者看到请求使用的是HTTP-1-1-HTTP-1-1默认进行持久连接-，它就可以利用持久连接的优点，当页面包含多个元素时-例如Applet，图片-，显著地减少下载所需要的时间。要实现这一点，Servlet需要在应答中发送一个Content-Length头，最简单的实现方法是：先把内容写入-ByteArrayOutputStream，然后在正式写出内容之前计算它的大小。" class="headerlink" title="Connection：处理完这次请求后是否断开连接还是继续保持连接。如果Servlet看到这里的值为“Keep- Alive”，或者看到请求使用的是HTTP 1.1(HTTP 1.1默认进行持久连接)，它就可以利用持久连接的优点，当页面包含多个元素时(例如Applet，图片)，显著地减少下载所需要的时间。要实现这一点，Servlet需要在应答中发送一个Content-Length头，最简单的实现方法是：先把内容写入 ByteArrayOutputStream，然后在正式写出内容之前计算它的大小。"></a>Connection：处理完这次请求后是否断开连接还是继续保持连接。如果Servlet看到这里的值为“Keep- Alive”，或者看到请求使用的是HTTP 1.1(HTTP 1.1默认进行持久连接)，它就可以利用持久连接的优点，当页面包含多个元素时(例如Applet，图片)，显著地减少下载所需要的时间。要实现这一点，Servlet需要在应答中发送一个Content-Length头，最简单的实现方法是：先把内容写入 ByteArrayOutputStream，然后在正式写出内容之前计算它的大小。</h4><p>Range：Range头域可以请求实体的一个或者多个子范围。例如，<br>表示头500个字节：bytes=0-499<br>表示第二个500字节：bytes=500-999<br>表示最后500个字节：bytes=-500<br>表示500字节以后的范围：bytes=500-<br>第一个和最后一个字节：bytes=0-0,-1<br>同时指定几个范围：bytes=500-600,601-999<br>但是服务器可以忽略此请求头，如果无条件GET包含Range请求头，响应会以状态码206(PartialContent)返回而不是以200 (OK)。<br>UA-Pixels，UA-Color，UA-OS，UA-CPU：由某些版本的IE浏览器所发送的非标准的请求头，表示屏幕大小、颜色深度、操作系统和CPU类型。<br>3.空行<br>它的作用是通过一个空行，告诉服务器请求头部到此为止。<br>4.请求数据<br>若方法字段是GET，则此项为空，没有数据<br>若方法字段是POST,则通常来说此处放置的就是要提交的数据<br>比如要使用POST方法提交一个表单，其中有user字段中数据为“admin”, password字段为123456，那么这里的请求数据就是 user=admin&amp;password=123456，使用&amp;来连接各个字段。<br>总的来说，HTTP请求报文格式就如下图所示</p>
<p>上面是POST方法，它的请求行URL段中一般是没有参数的，参数放在了报文体中。而GET方法的参数直接置于请求行URL中，报文体则为空。</p>
<h2 id="HTTP响应报文"><a href="#HTTP响应报文" class="headerlink" title="HTTP响应报文"></a>HTTP响应报文</h2><h4 id="同样的，HTTP响应报文也由三部分组成：响应行、响应头、响应体"><a href="#同样的，HTTP响应报文也由三部分组成：响应行、响应头、响应体" class="headerlink" title="同样的，HTTP响应报文也由三部分组成：响应行、响应头、响应体"></a>同样的，HTTP响应报文也由三部分组成：响应行、响应头、响应体</h4><h3 id="1-响应行"><a href="#1-响应行" class="headerlink" title="1.响应行"></a>1.响应行</h3><h4 id="响应行一般由协议版本、状态码及其描述组成-比如-HTTP-1-1-200-OK"><a href="#响应行一般由协议版本、状态码及其描述组成-比如-HTTP-1-1-200-OK" class="headerlink" title="响应行一般由协议版本、状态码及其描述组成 比如 HTTP/1.1 200 OK"></a>响应行一般由协议版本、状态码及其描述组成 比如 HTTP/1.1 200 OK</h4><h4 id="其中协议版本HTTP-1-1或者HTTP-1-0，200就是它的状态码，OK则为它的描述。"><a href="#其中协议版本HTTP-1-1或者HTTP-1-0，200就是它的状态码，OK则为它的描述。" class="headerlink" title="其中协议版本HTTP/1.1或者HTTP/1.0，200就是它的状态码，OK则为它的描述。"></a>其中协议版本HTTP/1.1或者HTTP/1.0，200就是它的状态码，OK则为它的描述。</h4><p>//常见状态码：<br>100<del>199：表示成功接收请求，要求客户端继续提交下一次请求才能完成整个处理过程。<br>200</del>299：表示成功接收请求并已完成整个处理过程。常用200<br>300<del>399：为完成请求，客户需进一步细化请求。例如：请求的资源已经移动一个新地址、常用302(意味着你请求我，我让你去找别人),307和304(我不给你这个资源，自己拿缓存)<br>400</del>499：客户端的请求有错误，常用404(意味着你请求的资源在web服务器中没有)403(服务器拒绝访问，权限不够)<br>500~599：服务器端出现错误，常用500<br>更详细的状态码信息</p>
<h3 id="2-响应头"><a href="#2-响应头" class="headerlink" title="2.响应头"></a>2.响应头</h3><p>响应头用于描述服务器的基本信息，以及数据的描述，服务器通过这些数据的描述信息，可以通知客户端如何处理等一会儿它回送的数据。<br>设置HTTP响应头往往和状态码结合起来。例如，有好几个表示“文档位置已经改变”的状态代码都伴随着一个Location头，而401(Unauthorized)状态代码则必须伴随一个WWW-Authenticate头。然而，即使在没有设置特殊含义的状态代码时，指定应答头也是很有用的。应答头可以用来完成：设置Cookie，指定修改日期，指示浏览器按照指定的间隔刷新页面，声明文档的长度以便利用持久HTTP连接，……等等许多其他任务。<br>常见的响应头字段含义：<br>Allow：服务器支持哪些请求方法(如GET、POST等)。<br>Content-Encoding：文档的编码(Encode)方法。只有在解码之后才可以得到Content-Type头指定的内容类型。利用gzip压缩文档能够显著地减少HTML文档的下载时间。Java的GZIPOutputStream可以很方便地进行gzip压缩，但只有Unix上的Netscape和Windows上的IE4、IE5才支持它。因此，Servlet应该通过查看Accept-Encoding头(即request.getHeader(“Accept- Encoding”))检查浏览器是否支持gzip，为支持gzip的浏览器返回经gzip压缩的HTML页面，为其他浏览器返回普通页面。<br>Content-Length：表示内容长度。只有当浏览器使用持久HTTP连接时才需要这个数据。如果你想要利用持久连接的优势，可以把输出文档写入 ByteArrayOutputStram，完成后查看其大小，然后把该值放入Content-Length头，最后通过byteArrayStream.writeTo(response.getOutputStream()发送内容。</p>
<h4 id="Content-Type：表示后面的文档属于什么MIME类型。Servlet默认为text-plain，但通常需要显式地指定为text-html。由于经常要设置-Content-Type，因此HttpServletResponse提供了一个专用的方法setContentType。"><a href="#Content-Type：表示后面的文档属于什么MIME类型。Servlet默认为text-plain，但通常需要显式地指定为text-html。由于经常要设置-Content-Type，因此HttpServletResponse提供了一个专用的方法setContentType。" class="headerlink" title="Content- Type：表示后面的文档属于什么MIME类型。Servlet默认为text/plain，但通常需要显式地指定为text/html。由于经常要设置 Content-Type，因此HttpServletResponse提供了一个专用的方法setContentType。"></a>Content- Type：表示后面的文档属于什么MIME类型。Servlet默认为text/plain，但通常需要显式地指定为text/html。由于经常要设置 Content-Type，因此HttpServletResponse提供了一个专用的方法setContentType。</h4><h4 id="Date：当前的GMT时间，例如，Date-Mon-31Dec200104-25-57GMT。Date描述的时间表示世界标准时，换算成本地时间，需要知道用户所在的时区。你可以用setDateHeader来设置这个头以避免转换时间格式的麻烦。"><a href="#Date：当前的GMT时间，例如，Date-Mon-31Dec200104-25-57GMT。Date描述的时间表示世界标准时，换算成本地时间，需要知道用户所在的时区。你可以用setDateHeader来设置这个头以避免转换时间格式的麻烦。" class="headerlink" title="Date：当前的GMT时间，例如，Date:Mon,31Dec200104:25:57GMT。Date描述的时间表示世界标准时，换算成本地时间，需要知道用户所在的时区。你可以用setDateHeader来设置这个头以避免转换时间格式的麻烦。"></a>Date：当前的GMT时间，例如，Date:Mon,31Dec200104:25:57GMT。Date描述的时间表示世界标准时，换算成本地时间，需要知道用户所在的时区。你可以用setDateHeader来设置这个头以避免转换时间格式的麻烦。</h4><h4 id="Expires：告诉浏览器把回送的资源缓存多长时间，-1或0则是不缓存。"><a href="#Expires：告诉浏览器把回送的资源缓存多长时间，-1或0则是不缓存。" class="headerlink" title="Expires：告诉浏览器把回送的资源缓存多长时间，-1或0则是不缓存。"></a>Expires：告诉浏览器把回送的资源缓存多长时间，-1或0则是不缓存。</h4><p>Last-Modified：文档的最后改动时间。客户可以通过If-Modified-Since请求头提供一个日期，该请求将被视为一个条件GET，只有改动时间迟于指定时间的文档才会返回，否则返回一个304(Not Modified)状态。Last-Modified也可用setDateHeader方法来设置。<br>Location：这个头配合302状态码使用，用于重定向接收者到一个新URI地址。表示客户应当到哪里去提取文档。Location通常不是直接设置的，而是通过HttpServletResponse的sendRedirect方法，该方法同时设置状态代码为302。<br>Refresh：告诉浏览器隔多久刷新一次，以秒计。<br>Server：服务器通过这个头告诉浏览器服务器的类型。Server响应头包含处理请求的原始服务器的软件信息。此域能包含多个产品标识和注释，产品标识一般按照重要性排序。Servlet一般不设置这个值，而是由Web服务器自己设置。<br>Set-Cookie：设置和页面关联的Cookie。Servlet不应使用response.setHeader(“Set-Cookie”, …)，而是应使用HttpServletResponse提供的专用方法addCookie。<br>Transfer-Encoding：告诉浏览器数据的传送格式。<br>WWW-Authenticate：客户应该在Authorization头中提供什么类型的授权信息?在包含401(Unauthorized)状态行的应答中这个头是必需的。例如，response.setHeader(“WWW-Authenticate”, “BASIC realm=”executives”“)。注意Servlet一般不进行这方面的处理，而是让Web服务器的专门机制来控制受密码保护页面的访问。<br>注：设置应答头最常用的方法是HttpServletResponse的setHeader，该方法有两个参数，分别表示应答头的名字和值。和设置状态代码相似，设置应答头应该在发送任何文档内容之前进行。<br>setDateHeader方法和setIntHeadr方法专门用来设置包含日期和整数值的应答头，前者避免了把Java时间转换为GMT时间字符串的麻烦，后者则避免了把整数转换为字符串的麻烦。<br>HttpServletResponse还提供了许多设置<br>setContentType：设置Content-Type头。大多数Servlet都要用到这个方法。<br>setContentLength：设置Content-Length头。对于支持持久HTTP连接的浏览器来说，这个函数是很有用的。<br>addCookie：设置一个Cookie(Servlet API中没有setCookie方法，因为应答往往包含多个Set-Cookie头)。</p>
<h3 id="3-响应体"><a href="#3-响应体" class="headerlink" title="3.响应体"></a>3.响应体</h3><p>响应体就是响应的消息体，如果是纯数据就是返回纯数据，如果请求的是HTML页面，那么返回的就是HTML代码，如果是JS就是JS代码，如此之类。<br>HTTP响应报文格式就如下图所示</p>
<p>通用头、实体头<br>HTTP的头域包括通用头，请求头，响应头和实体头四个部分。前面讲解了请求头和响应头，接下来看看通用头和实体头(这里可能和前面介绍的请求头、响应头有重复)。<br>(1)通用头域<br>通用头域包含请求和响应消息都支持的头域，通用头域包含Cache-Control、 Connection、Date、Pragma、Transfer-Encoding、Upgrade、Via。对通用头域的扩展要求通讯双方都支持此扩展，如果存在不支持的通用头域，一般将会作为实体头域处理。下面简单介绍几个通用头域。<br>常见通用头含义：</p>
<h4 id="Cache-Control：指定请求和响应遵循的缓存机制。在请求消息或响应消息中设置-Cache-Control并不会修改另一个消息处理过程中的缓存处理过程。请求时的缓存指令包括no-cache、no-store、max-age、-max-stale、min-fresh、only-if-cached，响应消息中的指令包括public、private、no-cache、no-store、no-transform、must-revalidate、proxy-revalidate、max-age。各个消息中的指令含义如下："><a href="#Cache-Control：指定请求和响应遵循的缓存机制。在请求消息或响应消息中设置-Cache-Control并不会修改另一个消息处理过程中的缓存处理过程。请求时的缓存指令包括no-cache、no-store、max-age、-max-stale、min-fresh、only-if-cached，响应消息中的指令包括public、private、no-cache、no-store、no-transform、must-revalidate、proxy-revalidate、max-age。各个消息中的指令含义如下：" class="headerlink" title="Cache-Control：指定请求和响应遵循的缓存机制。在请求消息或响应消息中设置 Cache-Control并不会修改另一个消息处理过程中的缓存处理过程。请求时的缓存指令包括no-cache、no-store、max-age、 max-stale、min-fresh、only-if-cached，响应消息中的指令包括public、private、no-cache、no- store、no-transform、must-revalidate、proxy-revalidate、max-age。各个消息中的指令含义如下："></a>Cache-Control：指定请求和响应遵循的缓存机制。在请求消息或响应消息中设置 Cache-Control并不会修改另一个消息处理过程中的缓存处理过程。请求时的缓存指令包括no-cache、no-store、max-age、 max-stale、min-fresh、only-if-cached，响应消息中的指令包括public、private、no-cache、no- store、no-transform、must-revalidate、proxy-revalidate、max-age。各个消息中的指令含义如下：</h4><p>Public指示响应可被任何缓存区缓存。 Private指示对于单个用户的整个或部分响应消息，不能被共享缓存处理。这允许服务器仅仅描述当用户的部分响应消息，此响应消息对于其他用户的请求无效。 no-cache指示请求或响应消息不能缓存 no-store用于防止重要的信息被无意的发布。在请求消息中发送将使得请求和响应消息都不使用缓存。 max-age指示客户机可以接收生存期不大于指定时间(以秒为单位)的响应。 min-fresh指示客户机可以接收响应时间小于当前时间加上指定时间的响应。 max-stale指示客户机可以接收超出超时期间的响应消息。如果指定max-stale消息的值，那么客户机可以接收超出超时期指定值之内的响应消息。<br>Date：表示消息发送的时间，时间的描述格式由rfc822定义。例如，Date:Mon,31Dec200104:25:57GMT。Date描述的时间表示世界标准时，换算成本地时间，需要知道用户所在的时区。<br>Pragma：用来包含实现特定的指令，最常用的是Pragma:no-cache。在HTTP/1.1协议中，它的含义和Cache-Control:no-cache相同。<br>(2)实体头域<br>请求消息和响应消息都可以包含实体信息，实体信息一般由实体头域和实体组成。实体头域包含关于实体的原信息，实体头包括Allow、Content- Base、Content-Encoding、Content-Language、 Content-Length、Content-Location、Content-MD5、Content-Range、Content-Type、 Etag、Expires、Last-Modified、extension-header。extension-header允许客户端定义新的实体头，但是这些域可能无法未接受方识别。实体可以是一个经过编码的字节流，它的编码方式由Content-Encoding或Content-Type定义，它的长度由Content-Length或Content-Range定义。<br>常见实体头含义：<br>Content-Encoding： 服务器通过这个头告诉浏览器数据的压缩格式。<br>Content-Length： 服务器通过这个头告诉浏览器回送数据的长度。<br>Content-Disposition：告诉浏览器以下载方式打开数据。</p>
<h4 id="Content-Type：服务器通过这个头告诉浏览器回送数据的类型。Content-Type实体头用于向接收方指示实体的介质类型，指定HEAD方法送到接收方的实体介质类型，或GET方法发送的请求介质类型。"><a href="#Content-Type：服务器通过这个头告诉浏览器回送数据的类型。Content-Type实体头用于向接收方指示实体的介质类型，指定HEAD方法送到接收方的实体介质类型，或GET方法发送的请求介质类型。" class="headerlink" title="Content-Type：服务器通过这个头告诉浏览器回送数据的类型。Content-Type实体头用于向接收方指示实体的介质类型，指定HEAD方法送到接收方的实体介质类型，或GET方法发送的请求介质类型。"></a>Content-Type：服务器通过这个头告诉浏览器回送数据的类型。Content-Type实体头用于向接收方指示实体的介质类型，指定HEAD方法送到接收方的实体介质类型，或GET方法发送的请求介质类型。</h4><p>Content-Range：用于指定整个实体中的一部分的插入位置，他也指示了整个实体的长度。在服务器向客户返回一个部分响应，它必须描述响应覆盖的范围和整个实体长度。一般格式：<br>Content-Range:bytes-unitSPfirst-byte-pos-last-byte-pos/entity-legth<br>例如，传送头500个字节次字段的形式：Content-Range:bytes0- 499/1234，如果一个http消息包含此节(例如，对范围请求的响应或对一系列范围的重叠请求)，Content-Range表示传送的范围， Content-Length表示实际传送的字节数。<br>Last-Modified：指定服务器上保存内容的最后修订时间。</p>
<h4 id="ETag：缓存相关的头"><a href="#ETag：缓存相关的头" class="headerlink" title="ETag：缓存相关的头"></a>ETag：缓存相关的头</h4><h4 id="Expires：告诉浏览器把回送的资源缓存多长时间-1或0则是不缓存"><a href="#Expires：告诉浏览器把回送的资源缓存多长时间-1或0则是不缓存" class="headerlink" title="Expires：告诉浏览器把回送的资源缓存多长时间 -1或0则是不缓存"></a>Expires：告诉浏览器把回送的资源缓存多长时间 -1或0则是不缓存</h4><p>其中三种禁止浏览器缓存的头字段：<br>Expires：-1或0<br>Cache-Control：no-cache<br>Pragma：no-cache<br>GET、POST区别<br>Http定义了与服务器交互的不同方法，最基本的方法有4种：GET、POST、PUT、DELETE。<br>而HTTP中的 GET，POST，PUT，DELETE 就对应着对URL资源的 查，改，增，删 4个操作。所以说：GET一般用于获取/查询资源信息，而POST一般用于更新资源信息。<br>主要区分一下get和post<br>1.提交数据的形式：<br>GET请求的数据会附在URL之后(就是把数据放置在HTTP协议头中)，会直接展现在地址栏中，以?分割URL和传输数据，参数之间以&amp;相连，如：login.action?name=hyddd&amp;password=idontknow&amp;verify=%E4%BD%A0%E5 %A5%BD。<br>如果数据是英文字母/数字，原样发送，如果是空格，转换为+，如果是中文/其他字符，则直接把字符串用BASE64加密，<br>得出如：%E4 %BD%A0%E5%A5%BD，其中%XX中的XX为该符号以16进制表示的ASCII。<br>而POST方法则会把数据放到请求数据字段中以&amp;分隔各个字段，请求行不包含数据参数，地址栏也不会额外附带参数<br>2.提交数据的大小<br>get方法提交数据的大小直接影响到了URL的长度，但HTTP协议规范中其实是没有对URL限制长度的，限制URL长度的是客户端或服务器的支持的不同所影响：比如IE对URL长度的限制是2083字节(2K+35)。对于其他浏览器，如Netscape、FireFox等，理论上没有长度限制，其限制取决于操作系统的支持。<br>post方式HTTP协议规范中也没有限定，起限制作用的是服务器的处理程序的处理能力。<br>所以大小的限制还是得受各个web服务器配置的不同而影响。<br>3.提交数据的安全<br>POST比GET方式的安全性要高<br>通过GET提交数据，用户名和密码将明文出现在URL上，因为一下几个原因get方式安全性会比post弱：<br>(1)登录页面有可能被浏览器缓存<br>(2)其他人查看浏览器的历史纪录，那么别人就可 以拿到你的账号和密码了<br>(3)当遇上跨站的攻击时，安全性的表现更差了<br>————————————————<br>版权声明：本文为CSDN博主「Good Inflation」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_29669143/article/details/112410252">https://blog.csdn.net/weixin_29669143/article/details/112410252</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-JS_Promise" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2022/03/30/JS_Promise/" class="article-date">
      <time datetime="2022-03-30T11:39:07.014Z" itemprop="datePublished">2022-03-30</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/03/30/JS_Promise/">JS_Promise</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="一-概述"><a href="#一-概述" class="headerlink" title="一 概述"></a>一 概述</h1><p>  Promise是异步编程的一种解决方案，可以替代传统的解决方案–回调函数和事件。ES6统一了用法，并原生提供了Promise对象。作为对象，Promise有一下两个特点： * （1）对象的状态不受外界影响。 * （2）一旦状态改变了就不会在变，也就是说任何时候Promise都只有一种状态。</p>
<h1 id="二-Promise的状态"><a href="#二-Promise的状态" class="headerlink" title="二 Promise的状态"></a>二 Promise的状态</h1><p>  Promise有三种状态，分别是：**Pending **（进行中）， ** Resolved <strong>(已完成)，</strong> Rejected ** (已失败)。Promise从Pending状态开始，如果成功就转到成功态，并执行resolve回调函数；如果失败就转到失败状态并执行reject回调函数。下面是Promise的规范图解</p>
<p><img src="https://img2020.cnblogs.com/blog/979149/202006/979149-20200611124813652-1901659292.png" alt="img"></p>
<h1 id="三-基本用法"><a href="#三-基本用法" class="headerlink" title="三 基本用法"></a>三 基本用法</h1><p>   可以通过Promise的构造函数创建Promise对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span></span><br><span class="line"><span class="function"><span class="title">setTimeout</span>(<span class="params"><span class="keyword">function</span>()&#123;                              </span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="built_in">console</span>.log(<span class="string">&quot;hello world&quot;</span>);&#125;,<span class="number">2000</span></span>)</span>;</span><br><span class="line">&#125;);    </span><br></pre></td></tr></table></figure>

<p>  Promise构造函数接收一个函数作为参数，该函数的两个参数是<code>resolve</code>，<code>reject</code>，它们由JavaScript引擎提供。其中<code>resolve</code>函数的作用是当Promise对象转移到成功,调用resolve并将操作结果作为其参数传递出去；<code>reject</code>函数的作用是单Promise对象的状态变为失败时，将操作报出的错误作为其参数传递出去。如下面的代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> greet = <span class="string">&quot;hello  world&quot;</span>;</span><br><span class="line">    resolve(greet);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">return</span> promise;</span><br><span class="line">&#125;</span><br><span class="line">greet().then(<span class="function"><span class="params">v</span>=&gt;</span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(v);<span class="comment">//*</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>上面的*行的输出结果就是greet的值，也就是<code>resolve()</code>传递出来的参数。</p>
<blockquote>
<p><strong>注意</strong>：创建一个Promise对象会立即执行里面的代码，所以为了更好的控制代码的运行时刻，可以将其包含在一个函数中，并将这个Promise作为函数的返回值。</p>
</blockquote>
<h1 id="四-Promise的then方法"><a href="#四-Promise的then方法" class="headerlink" title="四 Promise的then方法"></a>四 Promise的then方法</h1><p>  promise的then方法带有以下三个参数：成功回调，失败回调，前进回调，一般情况下只需要实现第一个，后面是可选的。Promise中最为重要的是状态，通过then的状态传递可以实现回调函数链式操作的实现。先执行以下代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> greet = <span class="string">&quot;hello  world&quot;</span>;</span><br><span class="line">    resolve(greet);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">return</span> promise;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = greet().then(<span class="function"><span class="params">v</span>=&gt;</span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(v);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(p);</span><br></pre></td></tr></table></figure>

<p>改程序的输出为：</p>
<p><img src="https://img2018.cnblogs.com/blog/1195929/201903/1195929-20190320105342166-1963167694.png" alt="img"></p>
<p>从中可以看出promise执行then还是一个promise，并且Promise的执行是异步的，因为<code>hello world</code>在最后一条输出语句的前面就打印出来，且Promise的状态为pending(进行中)。<br>  因为Promise执行then后还是Promise，所以就可以根据这一特性，不断的链式调用回调函数。下面是一个 例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> greet = <span class="string">&quot;hello  world&quot;</span>;</span><br><span class="line">        resolve(greet);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> promise;</span><br><span class="line">&#125;</span><br><span class="line">greet().then(<span class="function"><span class="params">v</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(v+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> v;</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="params">v</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(v+<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> v;</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="params">v</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(v+<span class="number">3</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="五-Promise的其他方法"><a href="#五-Promise的其他方法" class="headerlink" title="五 Promise的其他方法"></a>五 Promise的其他方法</h1><h2 id="reject用法"><a href="#reject用法" class="headerlink" title="reject用法"></a>reject用法</h2><p>  reject的作用就是把Promise的状态从pending置为rejected，这样在then中就能捕捉到reject的回调函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">judgeNumber</span>(<span class="params">num</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> promise1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">        num =<span class="number">5</span>;</span><br><span class="line">        <span class="keyword">if</span>(num&lt;<span class="number">5</span>)&#123;</span><br><span class="line">            resolve(<span class="string">&quot;num小于5，值为：&quot;</span>+num);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            reject(<span class="string">&quot;num不小于5，值为：&quot;</span>+num);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> promise1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">judgeNumber().then(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">message</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(message);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">message</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(message);</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><code>.then</code>后包含有两个方法，前一个执行resolve回调的参数，后一个执行reject回调的参数。</p>
<h2 id="catch用法"><a href="#catch用法" class="headerlink" title="catch用法"></a>catch用法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">judgeNumber</span>(<span class="params">num</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> promise1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">        num =<span class="number">5</span>;</span><br><span class="line">        <span class="keyword">if</span>(num&lt;<span class="number">5</span>)&#123;</span><br><span class="line">            resolve(<span class="string">&quot;num小于5，值为：&quot;</span>+num);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            reject(<span class="string">&quot;num不小于5，值为：&quot;</span>+num);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> promise1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">judgeNumber().then(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">message</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(message);</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line">.catch(<span class="function"><span class="keyword">function</span>(<span class="params">message</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(message);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>这个时候<code>catch</code>执行的是和<code>reject</code>一样的，也就是说如果Promise的状态变为reject时，会被catch捕捉到，不过需要特别注意的是如果前面设置了reject方法的回调函数，·则catch不会捕捉到状态变为<code>reject</code>的情况。<code>catch</code>还有一点不同的是，如果在<code>resolve</code>或者<code>reject</code>发生错误的时候，会被<code>catch</code>捕捉到，这与java，c++的错误处理时一样的，这样就能避免程序卡死在回调函数中了。</p>
<h2 id="all用法"><a href="#all用法" class="headerlink" title="all用法"></a>all用法</h2><p>  Promise的all方法提供了并行执行异步操作的能力，在all中所有异步操作结束后才执行回调。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">p1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> promise1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;p1的第一条输出语句&quot;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;p1的第二条输出语句&quot;</span>);</span><br><span class="line">        resolve(<span class="string">&quot;p1完成&quot;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> promise1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">p2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> promise2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;p2的第一条输出语句&quot;</span>);</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;<span class="built_in">console</span>.log(<span class="string">&quot;p2的第二条输出语句&quot;</span>);resolve(<span class="string">&quot;p2完成&quot;</span>)&#125;,<span class="number">2000</span>);</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> promise2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">p3</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> promise3 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;p3的第一条输出语句&quot;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;p3的第二条输出语句&quot;</span>);</span><br><span class="line">        resolve(<span class="string">&quot;p3完成&quot;</span>)</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span>  promise3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.all([p1(),p2(),p3()]).then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>运行结果如下：</p>
<p><img src="https://img2018.cnblogs.com/blog/1195929/201903/1195929-20190320105409280-172251752.png" alt="img"></p>
<p>这里可以看到p2的<code>resolve</code>放到一个<code>setTimeout</code>中，最后的<code>.then</code>也会等到所有Promise完成状态的改变后才执行。</p>
<h2 id="race用法"><a href="#race用法" class="headerlink" title="race用法"></a>race用法</h2><p>  在all中的回调函数中，等到所有的Promise都执行完，再来执行回调函数，race则不同它等到第一个Promise改变状态就开始执行回调函数。将上面的<code>all</code>改为<code>race</code>,得到</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.race([p1(),p2(),p3()]).then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>其运行结果为：<br><img src="https://img2018.cnblogs.com/blog/1195929/201903/1195929-20190320105428478-1399238791.png" alt="img"></p>
<p>红框中圈出了”p1完成”字样，说明当执行<code>then()</code>方法时，只有第一个promise的状态改变了。</p>
<p>这里还需要注意一个问题，promise的执行时异步的，比如下面这样：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">    resolve(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">promise.then(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">    i = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(i);</span><br></pre></td></tr></table></figure>

<p>得到的结果是undefined,这不是因为promise不能改变外部的值，而是因为当执行<code>console.log(i)</code>时，<code>then()</code>方法还没执行完。如果你将console.log(i)延迟输出就可以得到正确的结果：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span><span class="built_in">console</span>.log(i),<span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<p>所以不要在promise后面执行一些依赖promise改变的代码，因为可能promise中的代码并未执行完，或者你可以将其延迟输出。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-自我介绍" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2022/03/30/%E8%87%AA%E6%88%91%E4%BB%8B%E7%BB%8D/" class="article-date">
      <time datetime="2022-03-30T10:28:03.765Z" itemprop="datePublished">2022-03-30</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h4 id="面试官你好，我是来自四川师范大学2018级软件工程专业的一名大四的学生，"><a href="#面试官你好，我是来自四川师范大学2018级软件工程专业的一名大四的学生，" class="headerlink" title="面试官你好，我是来自四川师范大学2018级软件工程专业的一名大四的学生，"></a>面试官你好，我是来自四川师范大学2018级软件工程专业的一名大四的学生，</h4><h4 id="我是从大二的时候开始接触前端的，大一的时候学习学校的专业课，c语言，java等等课程，大二上学期学习web课程设计的时候，对那种数据直接在浏览器上直接展示比较感兴趣，就也学习了JS和css，"><a href="#我是从大二的时候开始接触前端的，大一的时候学习学校的专业课，c语言，java等等课程，大二上学期学习web课程设计的时候，对那种数据直接在浏览器上直接展示比较感兴趣，就也学习了JS和css，" class="headerlink" title="我是从大二的时候开始接触前端的，大一的时候学习学校的专业课，c语言，java等等课程，大二上学期学习web课程设计的时候，对那种数据直接在浏览器上直接展示比较感兴趣，就也学习了JS和css，"></a>我是从大二的时候开始接触前端的，大一的时候学习学校的专业课，c语言，java等等课程，大二上学期学习web课程设计的时候，对那种数据直接在浏览器上直接展示比较感兴趣，就也学习了JS和css，</h4><h4 id="在大三上学期软件工程前后端项目分小组的时候选择了前端开发，当时做的是一个学校教学管理系统，就按照学校教务处的教学管理系统做的，用的VUE-Elementui技术做的，我负责管理员端的班级管理和课程管理。后面做的就是悦乐APP，也是小组项目，因为小组没有后端人员，所以后台管理系统都是我一个人写接口然后做了这个后台管理系统的前后端，负责商品管理和店铺管理。"><a href="#在大三上学期软件工程前后端项目分小组的时候选择了前端开发，当时做的是一个学校教学管理系统，就按照学校教务处的教学管理系统做的，用的VUE-Elementui技术做的，我负责管理员端的班级管理和课程管理。后面做的就是悦乐APP，也是小组项目，因为小组没有后端人员，所以后台管理系统都是我一个人写接口然后做了这个后台管理系统的前后端，负责商品管理和店铺管理。" class="headerlink" title="在大三上学期软件工程前后端项目分小组的时候选择了前端开发，当时做的是一个学校教学管理系统，就按照学校教务处的教学管理系统做的，用的VUE+Elementui技术做的，我负责管理员端的班级管理和课程管理。后面做的就是悦乐APP，也是小组项目，因为小组没有后端人员，所以后台管理系统都是我一个人写接口然后做了这个后台管理系统的前后端，负责商品管理和店铺管理。"></a>在大三上学期软件工程前后端项目分小组的时候选择了前端开发，当时做的是一个学校教学管理系统，就按照学校教务处的教学管理系统做的，用的VUE+Elementui技术做的，我负责管理员端的班级管理和课程管理。后面做的就是悦乐APP，也是小组项目，因为小组没有后端人员，所以后台管理系统都是我一个人写接口然后做了这个后台管理系统的前后端，负责商品管理和店铺管理。</h4><h4 id="平常也在不断地学习前端的东西，做一点音乐小项目什么的"><a href="#平常也在不断地学习前端的东西，做一点音乐小项目什么的" class="headerlink" title="平常也在不断地学习前端的东西，做一点音乐小项目什么的"></a>平常也在不断地学习前端的东西，做一点音乐小项目什么的</h4>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2022 John Doe
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="A fast, simple &amp; powerful blog framework">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="Another simple and elegant theme for Hexo  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="Site Visitors"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="Page Hits"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="Back to Top"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="Comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="Go to Bottom"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>